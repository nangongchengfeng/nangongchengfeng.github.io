<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='简介：是一个流行的开源自动化服务器，而是一个强大的代码托管和协作平台。通过结合和，我们可以建立一个强大的定时任务自动化工作流程，实现代码拉取、构建、测试和部署的自动化。本篇博客将介绍如何使用与相结合，。。。。。。。'>
<title>实现无间断的自动化：Jenkins与GitLab的定时任务工作流程</title>

<link rel='canonical' href='https://www.ownit.top/p/202306121120/'>

<link rel="stylesheet" href="/scss/style.min.e1fdf36bb1177c018972ef7e22c6b53c7c5dd0fe53eb6ffb0152c5aabb2f6017.css"><meta property='og:title' content='实现无间断的自动化：Jenkins与GitLab的定时任务工作流程'>
<meta property='og:description' content='简介：是一个流行的开源自动化服务器，而是一个强大的代码托管和协作平台。通过结合和，我们可以建立一个强大的定时任务自动化工作流程，实现代码拉取、构建、测试和部署的自动化。本篇博客将介绍如何使用与相结合，。。。。。。。'>
<meta property='og:url' content='https://www.ownit.top/p/202306121120/'>
<meta property='og:site_name' content='南宫乘风'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='jenkins' /><meta property='article:tag' content='自动化' /><meta property='article:tag' content='gitlab' /><meta property='article:published_time' content='2023-06-12T11:20:03&#43;00:00'/><meta property='article:modified_time' content='2023-06-12T11:20:03&#43;00:00'/><meta property='og:image' content='https://www.ownit.top/title_pic/12.jpg' />
<meta name="twitter:title" content="实现无间断的自动化：Jenkins与GitLab的定时任务工作流程">
<meta name="twitter:description" content="简介：是一个流行的开源自动化服务器，而是一个强大的代码托管和协作平台。通过结合和，我们可以建立一个强大的定时任务自动化工作流程，实现代码拉取、构建、测试和部署的自动化。本篇博客将介绍如何使用与相结合，。。。。。。。"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://www.ownit.top/title_pic/12.jpg' />
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="切换菜单">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu227367ba8544f2fc7811ed9508937bec_102665_300x0_resize_box_3.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">🍥</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">南宫乘风</a></h1>
            <h2 class="site-description">当你的才华撑不起你的野心时，只有静下心学习才是唯一的出路</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://blog.csdn.net/heian_99'
                        target="_blank"
                        title="CSDN"
                        rel="me"
                    >
                        
                        
                            <?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN"
 "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">
<svg version="1.0" xmlns="http://www.w3.org/2000/svg"
 width="32.000000pt" height="32.000000pt" viewBox="0 0 32.000000 32.000000"
 preserveAspectRatio="xMidYMid meet">

<g transform="translate(0.000000,32.000000) scale(0.100000,-0.100000)"
fill="#000000" stroke="none">
<path d="M0 160 l0 -160 160 0 160 0 0 160 0 160 -160 0 -160 0 0 -160z m225
108 c24 -11 34 -41 16 -52 -4 -3 -17 1 -27 9 -43 32 -95 3 -109 -62 -5 -27 -2
-37 19 -58 29 -29 62 -32 94 -9 25 17 42 11 42 -15 0 -27 -51 -45 -107 -38
-70 8 -97 42 -91 115 4 48 10 60 41 89 39 35 76 42 122 21z"/>
</g>
</svg>

                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/nangongchengfeng/'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>主页</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>归档</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>搜索</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>关于</span>
            </a>
        </li>
        
        
        <li >
            <a href='/link/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>友链</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>暗色模式</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">目录</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#简介">简介：</a></li>
    <li><a href="#背景">背景</a></li>
    <li><a href="#优势">优势</a></li>
    <li><a href="#gitlab创建仓库">Gitlab创建仓库</a>
      <ol>
        <li><a href="#monitorsh"><strong>monitor.sh</strong></a></li>
      </ol>
    </li>
    <li><a href="#jenkins配置gitlab的认证凭证">Jenkins配置Gitlab的认证凭证</a></li>
    <li><a href="#jenkins设置定时任务">Jenkins设置定时任务</a></li>
    <li><a href="#jenkins定时任务执行">Jenkins定时任务执行</a>
      <ol>
        <li><a href="#时间">时间</a></li>
        <li><a href="#查询日志">查询日志</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/202306121120/">
                
                    <img src="/../../title_pic/12.jpg" loading="lazy" alt="Featured image of post 实现无间断的自动化：Jenkins与GitLab的定时任务工作流程" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/" >
                项目实战
            </a>
        
            <a href="/categories/jenkins/" >
                Jenkins
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/202306121120/">实现无间断的自动化：Jenkins与GitLab的定时任务工作流程</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            简介：是一个流行的开源自动化服务器，而是一个强大的代码托管和协作平台。通过结合和，我们可以建立一个强大的定时任务自动化工作流程，实现代码拉取、构建、测试和部署的自动化。本篇博客将介绍如何使用与相结合，。。。。。。。
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jun 12, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    阅读时长: 4 分钟
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="简介">简介：</h2>
<p>Jenkins是一个流行的开源自动化服务器，而GitLab是一个强大的代码托管和协作平台。通过结合Jenkins和GitLab，我们可以建立一个强大的定时任务自动化工作流程，实现代码拉取、构建、测试和部署的自动化。本篇博客将介绍如何使用Jenkins与GitLab相结合，构建一个完整的定时任务自动化流程。</p>
<h2 id="背景">背景</h2>
<p>目前我们的代码存放在gitlab中，有版本控制比较方便开发。现在有个Crontab的仓库存放，日常的定时任务脚本。
如果放在Linux的crontab上，代码更新完毕 需要及时拉取才会 执行新的代码，比较麻烦。这边就采用jenkins的crontab来执行定时任务</p>
<h2 id="优势">优势</h2>
<p>Jenkins可以满足您提到的核心需求，并提供以下功能：</p>
<ul>
<li>
<p>审计执行日志：Jenkins记录每个任务的执行日志，并提供可视化界面来查看和审计任务的执行历史。您可以随时查看任务的执行输出、错误信息以及任何产生的警告或异常。</p>
</li>
<li>
<p>任务超时强制kill：Jenkins允许您为每个任务设置超时时间。如果任务在指定的时间内未完成，Jenkins会强制终止任务的执行，以防止无限循环或资源占用等问题。</p>
</li>
<li>
<p>任务的超时重试：Jenkins提供了内置的插件，如Pipeline和Job DSL，可以轻松地编写自定义的任务流程，并支持任务的超时重试。您可以在任务失败或超时后自动触发重试，并设置重试次数和时间间隔，以确保任务能够成功完成。</p>
</li>
<li>
<p>错误重试和自定义次数：Jenkins提供了灵活的错误处理机制，您可以在任务执行失败时自定义处理逻辑。您可以设置任务在遇到错误时自动触发重试，并指定重试次数和重试间隔，以便应对临时性的错误和问题。</p>
</li>
</ul>
<p>Jenkins作为一个开源的自动化服务器，具有广泛的社区支持和丰富的插件生态系统，可以满足各种复杂的任务调度和自动化需求。通过适当的配置和使用插件，您可以实现高度定制化的任务调度和执行流程，满足您特定的需求，并确保任务的可靠执行和错误处理。</p>
<h2 id="gitlab创建仓库">Gitlab创建仓库</h2>
<ol>
<li>
<p>登录GitLab：打开您的Web浏览器，输入GitLab的URL，并使用您的GitLab账户登录。</p>
</li>
<li>
<p>导航到项目页面：登录后，您将看到GitLab的仪表板或项目列表。点击页面顶部的“+”按钮或导航栏上的“New project”按钮。</p>
</li>
<li>
<p>创建新项目：在新项目页面上，您需要提供以下信息来创建新的仓库：</p>
<ul>
<li>项目路径：指定项目的路径，也就是项目在GitLab上的URL地址。它将用于在仓库的URL中唯一标识您的项目。</li>
<li>可见级别：选择您希望谁能访问您的项目。您可以选择公开（Public）、私有（Private）或内部（Internal）可见性级别。</li>
<li>项目名称：为您的项目指定一个易于识别的名称。</li>
<li>描述（可选）：提供关于项目的简要描述，以便其他人了解项目的目的和内容。</li>
<li>初始化仓库：选择是否要初始化一个空的仓库，或者您可以选择从现有的代码库导入代码。</li>
</ul>
</li>
<li>
<p>完成设置：在提供必要信息后，单击页面下方的“Create project”按钮。GitLab将根据您提供的信息创建新的仓库，并将您重定向到新仓库的页面。</p>
</li>
<li>
<p>配置仓库（可选）：在新仓库页面上，您可以进一步配置仓库的设置，例如添加项目成员、设置分支保护规则、启用CI/CD等。这些设置可以根据您的具体需求进行调整。
<img src="/../../image/277229e1fa6f475fa37e8fcfd810abeb.png"
	
	
	
	loading="lazy"
	
	
>
添加测试脚本</p>
</li>
</ol>
<h3 id="monitorsh"><strong>monitor.sh</strong></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="nb">echo</span> <span class="s2">&#34;=======================&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="k">$(</span>date<span class="k">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @Author: danqing</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @Description: Host Daily Check Script</span>
</span></span><span class="line"><span class="cl"><span class="c1"># beseem CentOS6.X CentOS7.X</span>
</span></span><span class="line"><span class="cl"><span class="c1"># </span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Host Daily Check Script&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span> <span class="k">$(</span>id -u<span class="k">)</span> -gt <span class="m">0</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&#34;请用root用户执行此脚本！&#34;</span> <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> ! -d /root/check_log  <span class="o">]</span><span class="p">;</span><span class="k">then</span>
</span></span><span class="line"><span class="cl">  mkdir /root/check_log
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;/root/check_log检查日志存放目录创建成功&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;/root/check_log检查日志存放目录已存在&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">function</span> getSystem<span class="o">(){</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;############################ 系统信息检查 ############################&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">Default_LANG</span><span class="o">=</span><span class="si">${</span><span class="nv">LANG</span><span class="si">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">OS</span><span class="o">=</span><span class="k">$(</span>uname -o<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">Release</span><span class="o">=</span><span class="k">$(</span>cat /etc/redhat-release 2&gt;/dev/null<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">Kernel</span><span class="o">=</span><span class="k">$(</span>uname -r<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">Hostname</span><span class="o">=</span><span class="k">$(</span>uname -n<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">Nowdate</span><span class="o">=</span><span class="k">$(</span>date +<span class="s1">&#39;%F %T&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">LastReboot</span><span class="o">=</span><span class="k">$(</span>who -b <span class="p">|</span> awk <span class="s1">&#39;{print $3,$4}&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">uptime</span><span class="o">=</span><span class="k">$(</span>uptime <span class="p">|</span> sed <span class="s1">&#39;s/.*up \([^,]*\), .*/\1/&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34; 语言环境: </span><span class="nv">$Default_LANG</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34; 系统: </span><span class="nv">$OS</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34; 发行版本: </span><span class="nv">$Release</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34; 内核: </span><span class="nv">$Kernel</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34; 主机名: </span><span class="nv">$Hostname</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34; 当前时间: </span><span class="nv">$Nowdate</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34; 最后启动: </span><span class="nv">$LastReboot</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34; 运行时间: </span><span class="nv">$uptime</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">function</span> getCpu<span class="o">(){</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;############################ CPU检查 ############################&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">Physical_CPUs</span><span class="o">=</span><span class="k">$(</span>grep <span class="s2">&#34;physical id&#34;</span> /proc/cpuinfo<span class="p">|</span> sort <span class="p">|</span> uniq <span class="p">|</span> wc -l<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">Virt_CPUs</span><span class="o">=</span><span class="k">$(</span>grep <span class="s2">&#34;processor&#34;</span> /proc/cpuinfo <span class="p">|</span> wc -l<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">CPU_Kernels</span><span class="o">=</span><span class="k">$(</span>grep <span class="s2">&#34;cores&#34;</span> /proc/cpuinfo<span class="p">|</span>uniq<span class="p">|</span> awk -F <span class="s1">&#39;: &#39;</span> <span class="s1">&#39;{print $2}&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">CPU_Type</span><span class="o">=</span><span class="k">$(</span>grep <span class="s2">&#34;model name&#34;</span> /proc/cpuinfo <span class="p">|</span> awk -F <span class="s1">&#39;: &#39;</span> <span class="s1">&#39;{print $2}&#39;</span> <span class="p">|</span> sort <span class="p">|</span> uniq<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">CPU_Hz</span><span class="o">=</span><span class="k">$(</span>cat /proc/cpuinfo <span class="p">|</span> grep <span class="s2">&#34;cpu MHz&#34;</span> <span class="p">|</span> uniq <span class="p">|</span> awk -F<span class="s1">&#39;:&#39;</span> <span class="s1">&#39;{sub(/ /,&#34;&#34;,$2);printf &#34;%s MHz\n&#34;,$2}&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">CPU_Arch</span><span class="o">=</span><span class="k">$(</span>uname -m<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">CPU_Usage</span><span class="o">=</span><span class="k">$(</span>cat /proc/loadavg <span class="p">|</span> awk <span class="s1">&#39;{print $1}&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;物理CPU个数: </span><span class="nv">$Physical_CPUs</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;逻辑CPU个数: </span><span class="nv">$Virt_CPUs</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;每CPU核心数: </span><span class="nv">$CPU_Kernels</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;CPU型号: </span><span class="nv">$CPU_Type</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;CPU频率: </span><span class="nv">$CPU_Hz</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;CPU架构: </span><span class="nv">$CPU_Arch</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;CPU使用率: </span><span class="si">${</span><span class="nv">CPU_Usage</span><span class="si">}</span><span class="s2">%&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">function</span> getMemory<span class="o">(){</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;############################ 内存检查 ############################&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">Memory_Used</span><span class="o">=</span><span class="k">$(</span>awk <span class="s1">&#39;/MemTotal/{total=$2}/MemFree/{free=$2}END{print (total-free)/1024/1024}&#39;</span>  /proc/meminfo<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">Memory_Total</span><span class="o">=</span><span class="k">$(</span>awk <span class="s1">&#39;/MemTotal/{total=$2}END{print (total)/1024/1024}&#39;</span> /proc/meminfo<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># kb的换算是1000 kB的换算是1024</span>
</span></span><span class="line"><span class="cl"><span class="nv">Memory_Usage</span><span class="o">=</span><span class="k">$(</span>awk <span class="s1">&#39;/MemTotal/{total=$2}/MemFree/{free=$2}END{print (total-free)/total*100}&#39;</span>  /proc/meminfo<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;已使用内存/全部内存: </span><span class="si">${</span><span class="nv">Memory_Used</span><span class="si">}</span><span class="s2">GB/</span><span class="si">${</span><span class="nv">Memory_Total</span><span class="si">}</span><span class="s2">GB&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;内存使用率: </span><span class="si">${</span><span class="nv">Memory_Usage</span><span class="si">}</span><span class="s2">%&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">function</span> getDisk<span class="o">(){</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;############################ 硬盘检查 ############################&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">Disk_Count</span><span class="o">=</span><span class="k">$(</span>lsblk <span class="p">|</span>awk <span class="s1">&#39;/disk/{print $1}&#39;</span><span class="p">|</span>wc -l<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;硬盘数量: </span><span class="si">${</span><span class="nv">Disk_Count</span><span class="si">}</span><span class="s2">个&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;硬盘分区情况: &#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;`df -hTP | sort |grep -E &#34;</span>/sd<span class="p">|</span>/mapper<span class="s2">&#34; |awk &#39;{print (</span><span class="nv">$1</span><span class="s2"> &#34;</span><span class="se">\t\n</span><span class="s2">&#34; &#34;</span>  文件系统<span class="s2">&#34;</span><span class="nv">$2</span><span class="s2"> &#34;</span>  合计<span class="s2">&#34;</span><span class="nv">$3</span><span class="s2"> &#34;</span>  已用<span class="s2">&#34;</span><span class="nv">$4</span><span class="s2"> &#34;</span>  剩余<span class="s2">&#34;</span><span class="nv">$5</span><span class="s2"> &#34;</span>  使用率<span class="s2">&#34;</span><span class="nv">$6</span><span class="s2"> &#34;</span>  挂载点<span class="s2">&#34;</span><span class="nv">$7</span><span class="s2">)}&#39;`&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -P, --portability 使用 POSIX 输出格式,方便shell过滤处理</span>
</span></span><span class="line"><span class="cl">smartctl -V &gt;<span class="p">&amp;</span>/dev/null
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> -eq <span class="m">0</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;smartctl工具已安装,可以进行硬盘健康检测: &#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> i in <span class="k">$(</span>lsblk <span class="p">|</span>awk <span class="s1">&#39;/disk/{print $1}&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">do</span>
</span></span><span class="line"><span class="cl">      <span class="nb">echo</span> <span class="s2">&#34;硬盘&#34;</span><span class="nv">$i</span>   <span class="sb">`</span>smartctl -H /dev/<span class="nv">$i</span> <span class="p">|</span>grep -Ei <span class="s2">&#34;OK|PASSED|FAILED|Failure|Failed&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl">    <span class="k">done</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;smartctl工具未安装,无法进行硬盘健康检测&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="c1"># &#34;\n磁盘IO信息:$(iotop -bon 1 &amp;&gt;/dev/null || echo &#39;iotop 未安装信息获取失败&#39;)&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">function</span> getNetwork<span class="o">(){</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;############################ 网络检查 ############################&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">Network_Device</span><span class="o">=</span><span class="k">$(</span>cat /proc/net/dev <span class="p">|</span> awk <span class="s1">&#39;NR&gt;2 &amp;&amp; $1 !~/lo/ {sub(/:/,&#34;&#34;);print $1}&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> i in <span class="nv">$Network_Device</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#echo &#34;网卡：$i  状态: $(ip link show $Network_Device | awk &#39;NR==1{print $9}&#39;) RX: $(ethtool -g $Network_Device | grep &#34;RX:&#34; | tail -1 | awk &#39;{print $2}&#39;) TX: $(ethtool -g $Network_Device | grep &#34;TX:&#34; | tail -1 | awk &#39;{print $2}&#39;)&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># rx是接收(receive),tx是发送(transport)</span>
</span></span><span class="line"><span class="cl">  <span class="nv">Mac_Info</span><span class="o">=</span><span class="k">$(</span>ip link <span class="p">|</span> egrep -v <span class="s2">&#34;lo&#34;</span> <span class="p">|</span> grep link <span class="p">|</span> awk <span class="s1">&#39;{print $2}&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;MAC地址: </span><span class="nv">$Mac_Info</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">Private_Ip</span><span class="o">=</span><span class="k">$(</span>ip addr <span class="p">|</span> awk <span class="s1">&#39;/^[0-9]+: / {}; /inet.*global/ {print gensub(/(.*)\/(.*)/, &#34;\\1&#34;, &#34;g&#34;, $2)}&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;IP地址: </span><span class="nv">$Private_Ip</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Public_Ip=$(curl ifconfig.me -s)</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># echo &#34;公网IP地址: $Public_Ip&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">Gateway</span><span class="o">=</span><span class="k">$(</span>ip route <span class="p">|</span> grep default <span class="p">|</span> awk <span class="s1">&#39;{print $3}&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># echo &#34;网关地址: $Gateway&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Dns_Config=$(grep nameserver /etc/resolv.conf| grep -v &#34;#&#34; | awk &#39;{print $2}&#39; | tr &#39;\n&#39; &#39;,&#39; | sed &#39;s/,$//&#39;)</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># echo &#34;DNS地址: $Dns_Config&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;网关连接情况: </span><span class="k">$(</span>ping -c <span class="m">4</span> -i 0.5 -W <span class="m">3</span> <span class="nv">$Gateway</span> <span class="p">&amp;</span>&gt;/dev/null <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s1">&#39;正常通信&#39;</span> <span class="o">||</span> <span class="nb">echo</span> <span class="s1">&#39;无法通信&#39;</span><span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;外网连接情况: </span><span class="k">$(</span>ping -c <span class="m">4</span> -i 0.5 -W <span class="m">3</span> baidu.com <span class="p">&amp;</span>&gt;/dev/null <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s1">&#39;正常通信&#39;</span> <span class="o">||</span> <span class="nb">echo</span> <span class="s1">&#39;无法通信&#39;</span><span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># 发送4次请求包，每次间隔0.5秒，最长等待时间为3秒</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl"><span class="nv">Listen_Port</span><span class="o">=</span><span class="k">$(</span>ss -tuln <span class="p">|</span> grep LISTEN <span class="p">|</span> awk <span class="s1">&#39;{print $5}&#39;</span> <span class="p">|</span> awk -F: <span class="s1">&#39;{print $2$4}&#39;</span> <span class="p">|</span> sort <span class="p">|</span>uniq -d <span class="p">|</span> tr <span class="s1">&#39;\n&#39;</span> <span class="s1">&#39;,&#39;</span> <span class="p">|</span> sed <span class="s1">&#39;s/,$//&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;系统运行的端口: </span><span class="nv">$Listen_Port</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">function</span> check<span class="o">(){</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Host Daily Check Script&#34;</span>
</span></span><span class="line"><span class="cl">getSystem
</span></span><span class="line"><span class="cl">getCpu
</span></span><span class="line"><span class="cl">getMemory
</span></span><span class="line"><span class="cl">getDisk
</span></span><span class="line"><span class="cl">getNetwork
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="nv">RESULTFILE</span><span class="o">=</span><span class="s2">&#34;/root/check_log/check-`date +%Y%m%d`.txt&#34;</span>
</span></span><span class="line"><span class="cl">check &gt; <span class="nv">$RESULTFILE</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;检查结果：</span><span class="nv">$RESULTFILE</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">cat  <span class="nv">$RESULTFILE</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="jenkins配置gitlab的认证凭证">Jenkins配置Gitlab的认证凭证</h2>
<p>在Jenkins中配置GitLab的认证凭证，您可以按照以下步骤进行操作：</p>
<ol>
<li>
<p>登录Jenkins：打开您的Web浏览器，输入Jenkins的URL，并使用管理员账户登录到Jenkins控制台。</p>
</li>
<li>
<p>导航到凭据页面：在Jenkins控制台的主页上，点击左侧导航栏中的&quot;凭据&quot;（Credentials）选项。
<img src="/../../image/5f6302adb44b46a3b49ff01f12d01f2d.png"
	
	
	
	loading="lazy"
	
		alt="在这里插入图片描述"
	
	
></p>
</li>
<li>
<p>创建新的凭据：在凭据页面，点击&quot;系统&quot;（System）下方的&quot;全局凭据&quot;（Global credentials）选项。</p>
</li>
<li>
<p>添加凭据：在全局凭据页面，点击&quot;添加凭据&quot;（Add Credentials）按钮。</p>
</li>
<li>
<p>选择凭据类型：在&quot;添加凭据&quot;页面，选择GitLab凭据的类型。根据您的GitLab配置，可以选择不同的类型，例如&quot;Username with password&quot;（用户名和密码）或&quot;SSH Username with private key&quot;（SSH用户名和私钥）等。
<img src="/../../image/be1283115ae34ae2b61f180a16af1646.png"
	
	
	
	loading="lazy"
	
		alt="在这里插入图片描述"
	
	
></p>
</li>
<li>
<p>填写凭据信息：根据您选择的凭据类型，填写相关的凭据信息。例如，如果选择&quot;Username with password&quot;，则需要提供GitLab的用户名和密码；如果选择&quot;SSH Username with private key&quot;，则需要提供GitLab的SSH用户名和私钥等信息。
<img src="/../../image/2c236aa268c94b84a8f8de03d51a3274.png"
	
	
	
	loading="lazy"
	
		alt="在这里插入图片描述"
	
	
></p>
</li>
<li>
<p>保存凭据：完成填写凭据信息后，点击页面下方的&quot;保存&quot;（Save）按钮，将凭据保存到Jenkins中。</p>
</li>
<li>
<p>配置Jenkins项目：在Jenkins中的项目配置中，找到与GitLab相关的配置部分，例如构建触发器或源码管理。在这些配置中，您将看到&quot;凭据&quot;（Credentials）的选项。</p>
</li>
<li>
<p>选择凭据：在相关配置中，找到&quot;凭据&quot;（Credentials）选项，并选择您之前保存的GitLab凭据。</p>
</li>
<li>
<p>保存配置：完成凭据选择后，确保保存项目的配置。</p>
</li>
</ol>
<p>完成上述步骤后，Jenkins将能够使用您配置的GitLab凭据进行与GitLab的交互，例如拉取代码、触发构建等操作。这样，您就可以通过Jenkins与GitLab进行无缝集成，并实现持续集成和持续交付的自动化流程。</p>
<h2 id="jenkins设置定时任务">Jenkins设置定时任务</h2>
<ol>
<li>
<p>登录Jenkins：使用管理员账户登录到Jenkins控制台。</p>
</li>
<li>
<p>创建新项目：在Jenkins控制台主页上，点击&quot;新建任务&quot;（New Item）按钮。</p>
</li>
<li>
<p>输入项目名称：为新项目指定一个易于识别的名称，并选择自由风格的软件项目（FreeStyle Project）类型。
<img src="/../../image/b6092e2fcd3f42baa0be8d9264fa52d2.png"
	
	
	
	loading="lazy"
	
		alt="在这里插入图片描述"
	
	
></p>
</li>
<li>
<p>配置源码管理：在项目配置页面的&quot;源码管理&quot;（Source Code Management）部分，选择Git作为源码管理工具，并填写GitLab仓库的URL。</p>
</li>
<li>
<p>配置凭据：如果您之前在Jenkins中配置了GitLab的认证凭证，请在源码管理部分选择相应的凭据，以便Jenkins能够访问GitLab仓库。
<img src="/../../image/9037ad662c264df8b693eaf4045137ce.png"
	
	
	
	loading="lazy"
	
		alt="在这里插入图片描述"
	
	
></p>
</li>
<li>
<p>配置构建触发器：在项目配置页面的&quot;构建触发器&quot;（Build Triggers）部分，选择&quot;定时构建&quot;（Build periodically）选项。</p>
</li>
<li>
<p>设置定时任务：在&quot;定时构建&quot;选项中，使用Cron表达式指定定期执行任务的时间。例如，要每天的上午9点执行任务，可以使用&quot;0 9 * * *&ldquo;的Cron表达式。
<img src="/../../image/7c4998301a234eee891b9702a207ebed.png"
	
	
	
	loading="lazy"
	
		alt="在这里插入图片描述"
	
	
></p>
</li>
<li>
<p>配置构建步骤：在项目配置页面的&quot;构建&rdquo;（Build）部分，配置需要执行的构建步骤。这可以是构建脚本、测试命令、部署操作或任何其他您希望Jenkins执行的任务。
<img src="/../../image/784d607c9959442282da27290761c14c.png"
	
	
	
	loading="lazy"
	
		alt="在这里插入图片描述"
	
	
></p>
</li>
<li>
<p>保存配置：完成配置后，确保保存项目的配置。</p>
</li>
</ol>
<p>Jenkins将按照您设置的定时任务，定期拉取GitLab仓库中的代码，并执行您配置的构建步骤。您可以在Jenkins控制台的项目页面上查看每次构建的执行日志和结果，以及任何产生的警告或错误。</p>
<h2 id="jenkins定时任务执行">Jenkins定时任务执行</h2>
<h3 id="时间">时间</h3>
<p><img src="/../../image/cc6e47c6507145de9c0232eb2f52d266.png"
	
	
	
	loading="lazy"
	
		alt="在这里插入图片描述"
	
	
></p>
<h3 id="查询日志">查询日志</h3>
<p><img src="/../../image/b5aefef3b2d54e03bef842769bf14cac.png"
	
	
	
	loading="lazy"
	
		alt="在这里插入图片描述"
	
	
></p>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/jenkins/">jenkins</a>
        
            <a href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/">自动化</a>
        
            <a href="/tags/gitlab/">gitlab</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>未来的你，会感谢今天仍在努力奋斗的你</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">相关文章</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/202306171826/">
        
        
            <div class="article-image">
                
                    <img src="/../../title_pic/10.jpg" loading="lazy" data-key="202306171826" data-hash="/../../title_pic/10.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">提高错误日志处理效率！使用Python和钉钉机器人实现自动告警聚合</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/202405271605/">
        
        
            <div class="article-image">
                
                    <img src="/../../title_pic/74.jpg" loading="lazy" data-key="202405271605" data-hash="/../../title_pic/74.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">MongoDB数据库（10亿条数据）清理策略- 自动化过期数据删除实战</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/202405241437/">
        
        
            <div class="article-image">
                
                    <img src="/../../title_pic/45.jpg" loading="lazy" data-key="202405241437" data-hash="/../../title_pic/45.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">自动化重置数据库功能的探索与实践</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/202305132107/">
        
        
            <div class="article-image">
                
                    <img src="/../../title_pic/16.jpg" loading="lazy" data-key="202305132107" data-hash="/../../title_pic/16.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Flask轻松构建钉钉接口模版，实现自动化流程优化</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/202210311018/">
        
        
            <div class="article-image">
                
                    <img src="/../../title_pic/17.jpg" loading="lazy" data-key="202210311018" data-hash="/../../title_pic/17.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">GitLab集成gitlab-runner</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script
    src="https://giscus.app/client.js"
    data-repo="nangongchengfeng/nangongchengfeng.github.io"
    data-repo-id="R_kgDOIwWL4Q"
    data-category="Announcements"
    data-category-id="DIC_kwDOIwWL4c4Cg8Rs"
    data-mapping="title"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="light"
    data-lang="en"
    crossorigin="anonymous"
    async
></script>
<script>
    function setGiscusTheme(theme) {
        let giscus = document.querySelector("iframe.giscus-frame");
        if (giscus) {
            giscus.contentWindow.postMessage(
                {
                    giscus: {
                        setConfig: {
                            theme: theme,
                        },
                    },
                },
                "https://giscus.app"
            );
        }
    }

    (function () {
        addEventListener("message", (e) => {
            if (event.origin !== "https://giscus.app") return;
            handler();
        });
        window.addEventListener("onColorSchemeChange", handler);

        function handler() {
            if (document.documentElement.dataset.scheme === "light") {
                setGiscusTheme('light');
            } else {
                setGiscusTheme('dark_dimmed');
            }
        }
    })();
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2018 - 
        
        2024 南宫乘风
    </section>
    
    <section class="powerby">
        
            <a href="https://beian.miit.gov.cn/" target="_blank">备案号</a> <a href="https://beian.miit.gov.cn/" target="_blank">陕ICP备2021004364号-1</a> <br/>
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        主题 <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.16.0">Stack</a></b> 由 <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> 设计
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>

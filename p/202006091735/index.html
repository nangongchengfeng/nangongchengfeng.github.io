<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='ç›®å½•ã€ä¸ºä»€ä¹ˆéœ€è¦ä¸»ä»å¤åˆ¶ï¼Ÿã€ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶ã€å¤åˆ¶åŸç†ã€ä¸»ä»å¤åˆ¶ç®€ä»‹ã€å»¶æ—¶ä»åº“ã€åŠåŒæ­¥å¤åˆ¶ã€è¿‡æ»¤å¤åˆ¶ã€å¤åˆ¶ä¸»ä»æ•…éšœç›‘æ§åˆ†æå¤„ç†ä¸»ä»æ•…éšœç›‘æ§åˆ†æå¤„ç†ä¸»ä»å¤åˆ¶æ•…éšœåˆ†æã€ä¸ºä»€ä¹ˆéœ€è¦ä¸»ä»å¤åˆ¶ï¼Ÿã€åœ¨ä¸šåŠ¡å¤æ‚çš„ç³»ç»Ÿã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚'>
<title>ä»€ä¹ˆï¼Œä½ è¿˜ä¸ä¼šMysqlä¸»ä»å¤åˆ¶ï¼Ÿï¼Ÿï¼Ÿå¿«æ¥çœ‹</title>

<link rel='canonical' href='https://www.ownit.top/p/202006091735/'>

<link rel="stylesheet" href="/scss/style.min.e1fdf36bb1177c018972ef7e22c6b53c7c5dd0fe53eb6ffb0152c5aabb2f6017.css"><meta property='og:title' content='ä»€ä¹ˆï¼Œä½ è¿˜ä¸ä¼šMysqlä¸»ä»å¤åˆ¶ï¼Ÿï¼Ÿï¼Ÿå¿«æ¥çœ‹'>
<meta property='og:description' content='ç›®å½•ã€ä¸ºä»€ä¹ˆéœ€è¦ä¸»ä»å¤åˆ¶ï¼Ÿã€ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶ã€å¤åˆ¶åŸç†ã€ä¸»ä»å¤åˆ¶ç®€ä»‹ã€å»¶æ—¶ä»åº“ã€åŠåŒæ­¥å¤åˆ¶ã€è¿‡æ»¤å¤åˆ¶ã€å¤åˆ¶ä¸»ä»æ•…éšœç›‘æ§åˆ†æå¤„ç†ä¸»ä»æ•…éšœç›‘æ§åˆ†æå¤„ç†ä¸»ä»å¤åˆ¶æ•…éšœåˆ†æã€ä¸ºä»€ä¹ˆéœ€è¦ä¸»ä»å¤åˆ¶ï¼Ÿã€åœ¨ä¸šåŠ¡å¤æ‚çš„ç³»ç»Ÿã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚'>
<meta property='og:url' content='https://www.ownit.top/p/202006091735/'>
<meta property='og:site_name' content='å—å®«ä¹˜é£'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='æ•°æ®åº“' /><meta property='article:tag' content='linux' /><meta property='article:tag' content='mysql' /><meta property='article:tag' content='ä¸»ä»åŒæ­¥' /><meta property='article:tag' content='GTID' /><meta property='article:published_time' content='2020-06-09T17:35:28&#43;00:00'/><meta property='article:modified_time' content='2020-06-09T17:35:28&#43;00:00'/><meta property='og:image' content='https://www.ownit.top/title_pic/24.jpg' />
<meta name="twitter:title" content="ä»€ä¹ˆï¼Œä½ è¿˜ä¸ä¼šMysqlä¸»ä»å¤åˆ¶ï¼Ÿï¼Ÿï¼Ÿå¿«æ¥çœ‹">
<meta name="twitter:description" content="ç›®å½•ã€ä¸ºä»€ä¹ˆéœ€è¦ä¸»ä»å¤åˆ¶ï¼Ÿã€ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶ã€å¤åˆ¶åŸç†ã€ä¸»ä»å¤åˆ¶ç®€ä»‹ã€å»¶æ—¶ä»åº“ã€åŠåŒæ­¥å¤åˆ¶ã€è¿‡æ»¤å¤åˆ¶ã€å¤åˆ¶ä¸»ä»æ•…éšœç›‘æ§åˆ†æå¤„ç†ä¸»ä»æ•…éšœç›‘æ§åˆ†æå¤„ç†ä¸»ä»å¤åˆ¶æ•…éšœåˆ†æã€ä¸ºä»€ä¹ˆéœ€è¦ä¸»ä»å¤åˆ¶ï¼Ÿã€åœ¨ä¸šåŠ¡å¤æ‚çš„ç³»ç»Ÿã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://www.ownit.top/title_pic/24.jpg' />
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu227367ba8544f2fc7811ed9508937bec_102665_300x0_resize_box_3.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ¥</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">å—å®«ä¹˜é£</a></h1>
            <h2 class="site-description">å½“ä½ çš„æ‰åæ’‘ä¸èµ·ä½ çš„é‡å¿ƒæ—¶ï¼Œåªæœ‰é™ä¸‹å¿ƒå­¦ä¹ æ‰æ˜¯å”¯ä¸€çš„å‡ºè·¯</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://blog.csdn.net/heian_99'
                        target="_blank"
                        title="CSDN"
                        rel="me"
                    >
                        
                        
                            <?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN"
 "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">
<svg version="1.0" xmlns="http://www.w3.org/2000/svg"
 width="32.000000pt" height="32.000000pt" viewBox="0 0 32.000000 32.000000"
 preserveAspectRatio="xMidYMid meet">

<g transform="translate(0.000000,32.000000) scale(0.100000,-0.100000)"
fill="#000000" stroke="none">
<path d="M0 160 l0 -160 160 0 160 0 0 160 0 160 -160 0 -160 0 0 -160z m225
108 c24 -11 34 -41 16 -52 -4 -3 -17 1 -27 9 -43 32 -95 3 -109 -62 -5 -27 -2
-37 19 -58 29 -29 62 -32 94 -9 25 17 42 11 42 -15 0 -27 -51 -45 -107 -38
-70 8 -97 42 -91 115 4 48 10 60 41 89 39 35 76 42 122 21z"/>
</g>
</svg>

                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/nangongchengfeng/'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>ä¸»é¡µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>å½’æ¡£</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº</span>
            </a>
        </li>
        
        
        <li >
            <a href='/link/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>å‹é“¾</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>æš—è‰²æ¨¡å¼</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li>
      <ol>
        <li><a href="#image20200609163414418png"><img src="../../image/20200609163414418.png" alt=""></a></li>
        <li><a href="#1ä¸ºä»€ä¹ˆéœ€è¦ä¸»ä»å¤åˆ¶">1ã€<strong>ä¸ºä»€ä¹ˆéœ€è¦ä¸»ä»å¤åˆ¶ï¼Ÿ</strong></a></li>
        <li><a href="#2ä»€ä¹ˆæ˜¯mysqlä¸»ä»å¤åˆ¶">2ã€ä»€ä¹ˆæ˜¯mysqlä¸»ä»å¤åˆ¶</a></li>
        <li><a href="#3mysqlå¤åˆ¶åŸç†">3ã€Mysqlå¤åˆ¶åŸç†</a></li>
        <li><a href="#4ä¸»ä»å¤åˆ¶ç®€ä»‹">4ã€ä¸»ä»å¤åˆ¶ç®€ä»‹</a></li>
        <li><a href="#5å»¶æ—¶ä»åº“">5ã€Â å»¶æ—¶ä»åº“</a></li>
        <li><a href="#6åŠåŒæ­¥å¤åˆ¶">6ã€åŠåŒæ­¥å¤åˆ¶</a></li>
        <li><a href="#7è¿‡æ»¤å¤åˆ¶">7ã€è¿‡æ»¤å¤åˆ¶</a></li>
        <li><a href="#8gtidå¤åˆ¶">8ã€GTIDå¤åˆ¶</a></li>
        <li><a href="#9-ä¸»ä»æ•…éšœç›‘æ§åˆ†æå¤„ç†">9. ä¸»ä»æ•…éšœç›‘æ§\åˆ†æ\å¤„ç†</a></li>
        <li><a href="#ä¸»ä»å¤åˆ¶æ•…éšœåˆ†æ">ä¸»ä»å¤åˆ¶æ•…éšœåˆ†æ</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/202006091735/">
                
                    <img src="/../../title_pic/24.jpg" loading="lazy" alt="Featured image of post ä»€ä¹ˆï¼Œä½ è¿˜ä¸ä¼šMysqlä¸»ä»å¤åˆ¶ï¼Ÿï¼Ÿï¼Ÿå¿«æ¥çœ‹" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/mysql/" >
                MySQL
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/202006091735/">ä»€ä¹ˆï¼Œä½ è¿˜ä¸ä¼šMysqlä¸»ä»å¤åˆ¶ï¼Ÿï¼Ÿï¼Ÿå¿«æ¥çœ‹</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            ç›®å½•ã€ä¸ºä»€ä¹ˆéœ€è¦ä¸»ä»å¤åˆ¶ï¼Ÿã€ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶ã€å¤åˆ¶åŸç†ã€ä¸»ä»å¤åˆ¶ç®€ä»‹ã€å»¶æ—¶ä»åº“ã€åŠåŒæ­¥å¤åˆ¶ã€è¿‡æ»¤å¤åˆ¶ã€å¤åˆ¶ä¸»ä»æ•…éšœç›‘æ§åˆ†æå¤„ç†ä¸»ä»æ•…éšœç›‘æ§åˆ†æå¤„ç†ä¸»ä»å¤åˆ¶æ•…éšœåˆ†æã€ä¸ºä»€ä¹ˆéœ€è¦ä¸»ä»å¤åˆ¶ï¼Ÿã€åœ¨ä¸šåŠ¡å¤æ‚çš„ç³»ç»Ÿã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jun 09, 2020</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    é˜…è¯»æ—¶é•¿: 8 åˆ†é’Ÿ
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <p><strong>ç›®å½•</strong></p>
<p><a class="link" href="#1%E3%80%81%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%EF%BC%9F" >1ã€ä¸ºä»€ä¹ˆéœ€è¦ä¸»ä»å¤åˆ¶ï¼Ÿ</a></p>
<p><a class="link" href="#2%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AFmysql%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6" >2ã€ä»€ä¹ˆæ˜¯mysqlä¸»ä»å¤åˆ¶</a></p>
<p><a class="link" href="#3%E3%80%81Mysql%E5%A4%8D%E5%88%B6%E5%8E%9F%E7%90%86" >3ã€Mysqlå¤åˆ¶åŸç†</a></p>
<p><a class="link" href="#4%E3%80%81%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E7%AE%80%E4%BB%8B" >4ã€ä¸»ä»å¤åˆ¶ç®€ä»‹</a></p>
<p><a class="link" href="#5%E3%80%81%C2%A0%E5%BB%B6%E6%97%B6%E4%BB%8E%E5%BA%93" >5ã€Â å»¶æ—¶ä»åº“</a></p>
<p><a class="link" href="#6%E3%80%81%E5%8D%8A%E5%90%8C%E6%AD%A5%E5%A4%8D%E5%88%B6" >6ã€åŠåŒæ­¥å¤åˆ¶</a></p>
<p><a class="link" href="#7%E3%80%81%E8%BF%87%E6%BB%A4%E5%A4%8D%E5%88%B6" >7ã€è¿‡æ»¤å¤åˆ¶</a></p>
<p><a class="link" href="#8%E3%80%81GTID%E5%A4%8D%E5%88%B6" >8ã€GTIDå¤åˆ¶</a></p>
<p><a class="link" href="#9.%20%e4%b8%bb%e4%bb%8e%e6%95%85%e9%9a%9c%e7%9b%91%e6%8e%a7%5c%e5%88%86%e6%9e%90%5c%e5%a4%84%e7%90%86" >9. ä¸»ä»æ•…éšœç›‘æ§\åˆ†æ\å¤„ç†</a></p>
<p><a class="link" href="#%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E6%95%85%E9%9A%9C%E5%88%86%E6%9E%90" >ä¸»ä»å¤åˆ¶æ•…éšœåˆ†æ</a></p>
<hr>
<h3 id="image20200609163414418png"><img src="/../../image/20200609163414418.png"
	
	
	
	loading="lazy"
	
	
></h3>
<h3 id="1ä¸ºä»€ä¹ˆéœ€è¦ä¸»ä»å¤åˆ¶">1ã€<strong>ä¸ºä»€ä¹ˆéœ€è¦ä¸»ä»å¤åˆ¶ï¼Ÿ</strong></h3>
<p>1ã€åœ¨ä¸šåŠ¡å¤æ‚çš„ç³»ç»Ÿä¸­ï¼Œæœ‰è¿™ä¹ˆä¸€ä¸ªæƒ…æ™¯ï¼Œæœ‰ä¸€å¥sqlè¯­å¥éœ€è¦é”è¡¨ï¼Œå¯¼è‡´æš‚æ—¶ä¸èƒ½ä½¿ç”¨è¯»çš„æœåŠ¡ï¼Œé‚£ä¹ˆå°±å¾ˆå½±å“è¿è¡Œä¸­çš„ä¸šåŠ¡ï¼Œä½¿ç”¨ä¸»ä»å¤åˆ¶ï¼Œè®©ä¸»åº“è´Ÿè´£å†™ï¼Œä»åº“è´Ÿè´£è¯»ï¼Œè¿™æ ·ï¼Œå³ä½¿ä¸»åº“å‡ºç°äº†é”è¡¨çš„æƒ…æ™¯ï¼Œé€šè¿‡è¯»ä»åº“ä¹Ÿå¯ä»¥ä¿è¯ä¸šåŠ¡çš„æ­£å¸¸è¿ä½œã€‚</p>
<p>2ã€åšæ•°æ®çš„çƒ­å¤‡</p>
<p>3ã€æ¶æ„çš„æ‰©å±•ã€‚ä¸šåŠ¡é‡è¶Šæ¥è¶Šå¤§ï¼ŒI/Oè®¿é—®é¢‘ç‡è¿‡é«˜ï¼Œå•æœºæ— æ³•æ»¡è¶³ï¼Œæ­¤æ—¶åšå¤šåº“çš„å­˜å‚¨ï¼Œé™ä½ç£ç›˜I/Oè®¿é—®çš„é¢‘ç‡ï¼Œæé«˜å•ä¸ªæœºå™¨çš„I/Oæ€§èƒ½ã€‚</p>
<h3 id="2ä»€ä¹ˆæ˜¯mysqlä¸»ä»å¤åˆ¶">2ã€ä»€ä¹ˆæ˜¯mysqlä¸»ä»å¤åˆ¶</h3>
<p>Mysqlä¸»ä»å¤åˆ¶æ˜¯æŒ‡æ•°æ®å¯ä»¥ä»ä¸€ä¸ªmysqlæ•°æ®åº“æœåŠ¡å™¨èŠ‚ç‚¹å¤åˆ¶åˆ°å¦ä¸€ä¸ªæˆ–è€…å¤šä¸ªèŠ‚ç‚¹ã€‚</p>
<p>Mysqlé»˜è®¤é‡‡ç”¨å¼‚æ­¥å¤åˆ¶æ–¹å¼ï¼Œè¿™æ ·ä»èŠ‚ç‚¹ä¸ç”¨ä¸€ç›´è®¿é—®ä¸»æœåŠ¡å™¨æ¥è·Ÿæ–°è‡ªå·±çš„æ•°æ®ï¼Œæ•°æ®çš„æ›´æ–°å¯ä»¥åœ¨è¿œç¨‹è¿æ¥ä¸Šè¿›è¡Œï¼Œä»èŠ‚ç‚¹å¯ä»¥å¤åˆ¶ä¸»æ•°æ®åº“ä¸­çš„æ‰€æœ‰æ•°æ®åº“æˆ–è€…ç‰¹å®šçš„æ•°æ®åº“ï¼Œæˆ–è€…ç‰¹å®šçš„è¡¨ã€‚</p>
<h3 id="3mysqlå¤åˆ¶åŸç†">3ã€Mysqlå¤åˆ¶åŸç†</h3>
<p><strong>åŸç†ï¼š</strong></p>
<p><strong>ï¼ˆ1ï¼‰masteræœåŠ¡å™¨å°†æ•°æ®çš„æ”¹å˜è®°å½•äºŒè¿›åˆ¶binlogæ—¥å¿—ï¼Œå½“masterçš„æ•°æ®å‘ç”Ÿæ”¹å˜æ˜¯ï¼Œè¿™å°†æ”¹å˜å†™å…¥äºŒè¿›åˆ¶æ—¥å¿—ä¸­ï¼›</strong></p>
<p><strong>ï¼ˆ2ï¼‰slaveæœåŠ¡å™¨ä¼šåœ¨ä¸€å®šæ—¶é—´é—´éš”å†…å¯¹masteräºŒè¿›åˆ¶æ—¥å¿—è¿›è¡Œæ¢æµ‹æ˜¯å¦å‘ç”Ÿæ”¹å˜ï¼Œå¦‚æœå‘ç”Ÿæ”¹å˜ï¼Œåˆ™å¼€å§‹ä¸€ä¸ªIOçº¿ç¨‹è¯·æ±‚masteräºŒè¿›åˆ¶æ—¶é—´</strong></p>
<p><strong>ï¼ˆ3ï¼‰åŒæ—¶ä¸»èŠ‚ç‚¹ä¸ºæ¯ä¸ªIOçº¿ç¨‹å¯åŠ¨ä¸€ä¸ªdumpçº¿ç¨‹ï¼Œç”¨äºå‘å…¶å‘é€äºŒè¿›åˆ¶äº‹ä»¶ï¼Œå¹¶ä¿å­˜è‡³ä»èŠ‚ç‚¹æœ¬åœ°çš„ä¸­ç»§æ—¥å¿—ä¸­ï¼Œä»èŠ‚ç‚¹å°†å¯åŠ¨sqlçº¿ç¨‹ä»ä¸­ç»§æ—¥å¿—è¯»å–äºŒè¿›åˆ¶æ—¥å¿—ï¼Œåœ¨æœ¬åœ°é‡æ”¾ï¼Œä½¿å¾—å…¶æ•°æ®å’Œä¸»èŠ‚ç‚¹çš„ä¿æŒä¸€è‡´ï¼Œæœ€åIOçº¿ç¨‹å’Œsqlçº¿ç¨‹è¿›å…¥ç¡çœ çŠ¶æ€ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡å”¤é†’</strong></p>
<blockquote>
<ul>
<li><strong>ä»åº“ä¼šç”Ÿæˆä¸¤ä¸ªçº¿ç¨‹,ä¸€ä¸ªI/Oçº¿ç¨‹,ä¸€ä¸ªSQLçº¿ç¨‹;</strong></li>
<li><strong>I/Oçº¿ç¨‹ä¼šå»è¯·æ±‚ä¸»åº“çš„binlog,å¹¶å°†å¾—åˆ°çš„binlogå†™åˆ°æœ¬åœ°çš„relay-log(ä¸­ç»§æ—¥å¿—)æ–‡ä»¶ä¸­;</strong></li>
<li><strong>ä¸»åº“ä¼šç”Ÿæˆä¸€ä¸ªlog dumpçº¿ç¨‹,ç”¨æ¥ç»™ä»åº“I/Oçº¿ç¨‹ä¼ binlog;</strong></li>
<li><strong>SQLçº¿ç¨‹,ä¼šè¯»å–relay logæ–‡ä»¶ä¸­çš„æ—¥å¿—,å¹¶è§£ææˆsqlè¯­å¥é€ä¸€æ‰§è¡Œ;</strong></li>
</ul>
</blockquote>
<p><strong>æ³¨æ„ï¼š</strong></p>
<p>1ã€masterå°†æ“ä½œè¯­å¥è®°å½•åˆ°binlogæ—¥å¿—ä¸­ï¼Œç„¶åæˆäºˆslaveè¿œç¨‹è¿æ¥çš„æƒé™ï¼ˆmasterä¸€å®šè¦å¼€å¯binlogäºŒè¿›åˆ¶æ—¥å¿—åŠŸèƒ½ï¼›é€šå¸¸ä¸ºäº†æ•°æ®å®‰å…¨è€ƒè™‘ï¼Œslaveä¹Ÿå¼€å¯binlogåŠŸèƒ½ï¼‰ã€‚</p>
<p>2ã€slaveå¼€å¯ä¸¤ä¸ªçº¿ç¨‹ï¼šIOçº¿ç¨‹å’ŒSQLçº¿ç¨‹ã€‚å…¶ä¸­ï¼šIOçº¿ç¨‹è´Ÿè´£è¯»å–masterçš„binlogå†…å®¹åˆ°ä¸­ç»§æ—¥å¿—relay logé‡Œï¼›SQLçº¿ç¨‹è´Ÿè´£ä»relay logæ—¥å¿—é‡Œè¯»å‡ºbinlogå†…å®¹ï¼Œå¹¶æ›´æ–°åˆ°slaveçš„æ•°æ®åº“é‡Œï¼Œè¿™æ ·å°±èƒ½ä¿è¯slaveæ•°æ®å’Œmasteræ•°æ®ä¿æŒä¸€è‡´äº†ã€‚</p>
<p>3ã€Mysqlå¤åˆ¶è‡³å°‘éœ€è¦ä¸¤ä¸ªMysqlçš„æœåŠ¡ï¼Œå½“ç„¶MysqlæœåŠ¡å¯ä»¥åˆ†å¸ƒåœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œä¹Ÿå¯ä»¥åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šå¯åŠ¨å¤šä¸ªæœåŠ¡ã€‚</p>
<p>4ã€Mysqlå¤åˆ¶æœ€å¥½ç¡®ä¿masterå’ŒslaveæœåŠ¡å™¨ä¸Šçš„Mysqlç‰ˆæœ¬ç›¸åŒï¼ˆå¦‚æœä¸èƒ½æ»¡è¶³ç‰ˆæœ¬ä¸€è‡´ï¼Œé‚£ä¹ˆè¦ä¿è¯masterä¸»èŠ‚ç‚¹çš„ç‰ˆæœ¬ä½äºslaveä»èŠ‚ç‚¹çš„ç‰ˆæœ¬ï¼‰</p>
<p>5ã€masterå’Œslaveä¸¤èŠ‚ç‚¹é—´æ—¶é—´éœ€åŒæ­¥</p>
<h3 id="4ä¸»ä»å¤åˆ¶ç®€ä»‹">4ã€ä¸»ä»å¤åˆ¶ç®€ä»‹</h3>
<blockquote>
<p>1.1. åŸºäºäºŒè¿›åˆ¶æ—¥å¿—å¤åˆ¶çš„<br>
1.2. ä¸»åº“çš„ä¿®æ”¹æ“ä½œä¼šè®°å½•äºŒè¿›åˆ¶æ—¥å¿—<br>
1.3. ä»åº“ä¼šè¯·æ±‚æ–°çš„äºŒè¿›åˆ¶æ—¥å¿—å¹¶å›æ”¾,æœ€ç»ˆè¾¾åˆ°ä¸»ä»æ•°æ®åŒæ­¥<br>
1.4. ä¸»ä»å¤åˆ¶æ ¸å¿ƒåŠŸèƒ½:<br>
è¾…åŠ©å¤‡ä»½,å¤„ç†ç‰©ç†æŸå Â  Â  Â  Â  Â  Â  Â  Â  Â Â <br>
æ‰©å±•æ–°å‹çš„æ¶æ„:é«˜å¯ç”¨,é«˜æ€§èƒ½,åˆ†å¸ƒå¼æ¶æ„ç­‰</p>
</blockquote>
<p><strong>å‰æ</strong></p>
<ul>
<li>2.1 ä¸¤å°ä»¥ä¸Šmysqlå®ä¾‹ ,server_id,server_uuidä¸åŒ</li>
<li>2.2 ä¸»åº“å¼€å¯äºŒè¿›åˆ¶æ—¥å¿—</li>
<li>Â 2.3 ä¸“ç”¨çš„å¤åˆ¶ç”¨æˆ·</li>
<li>2.4 ä¿è¯ä¸»ä»å¼€å¯ä¹‹å‰çš„æŸä¸ªæ—¶é—´ç‚¹,ä»åº“æ•°æ®æ˜¯å’Œä¸»åº“ä¸€è‡´(è¡¥è¯¾)</li>
<li>2.5 å‘ŠçŸ¥ä»åº“,å¤åˆ¶user,passwd,IP port,ä»¥åŠå¤åˆ¶èµ·ç‚¹(change master to)</li>
<li>2.6 çº¿ç¨‹(ä¸‰ä¸ª):Dump thread Â IO thread Â SQL thread å¼€å¯(start slave)</li>
</ul>
<p><strong>ä¸»ä»å¤åˆ¶æ­å»ºè¿‡ç¨‹</strong></p>
<p><strong>æ¸…ç†ä¸»åº“æ•°æ®</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">rm -rf /data/3307/data/*
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>é‡æ–°åˆå§‹åŒ–3307</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mysqld --initialize-insecure --user<span class="o">=</span>mysql --basedir<span class="o">=</span>/app/mysql --datadir<span class="o">=</span>/data/3307/data
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ä¿®æ”¹my.cnf ,å¼€å¯äºŒè¿›åˆ¶æ—¥å¿—åŠŸèƒ½</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@db01 3307<span class="o">]</span><span class="c1"># vim /data/3307/my.cnf </span>
</span></span><span class="line"><span class="cl"><span class="nv">log_bin</span><span class="o">=</span>/data/3307/data/mysql-bin
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>å¯åŠ¨æ‰€æœ‰èŠ‚ç‚¹</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@db01 3307<span class="o">]</span><span class="c1"># systemctl start mysqld3307</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@db01 3307<span class="o">]</span><span class="c1"># systemctl start mysqld3308</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@db01 3307<span class="o">]</span><span class="c1"># systemctl start mysqld3309</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@db01 3307<span class="o">]</span><span class="c1"># ps -ef |grep mysqld</span>
</span></span><span class="line"><span class="cl">mysql      <span class="m">3684</span>      <span class="m">1</span>  <span class="m">4</span> 09:59 ?        00:00:00 /app/mysql/bin/mysqld --defaults-file<span class="o">=</span>/data/3307/my.cnf
</span></span><span class="line"><span class="cl">mysql      <span class="m">3719</span>      <span class="m">1</span>  <span class="m">7</span> 09:59 ?        00:00:00 /app/mysql/bin/mysqld --defaults-file<span class="o">=</span>/data/3308/my.cnf
</span></span><span class="line"><span class="cl">mysql      <span class="m">3754</span>      <span class="m">1</span>  <span class="m">8</span> 09:59 ?        00:00:00 /app/mysql/bin/mysqld --defaults-file<span class="o">=</span>/data/3309/my.cnf
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@db01 3307<span class="o">]</span><span class="c1"># mysql -S /data/3307/mysql.sock -e &#34;select @@server_id&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@db01 3307<span class="o">]</span><span class="c1"># mysql -S /data/3308/mysql.sock -e &#34;select @@server_id&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@db01 3307<span class="o">]</span><span class="c1"># mysql -S /data/3309/mysql.sock -e &#34;select @@server_id&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ä¸»åº“ä¸­åˆ›å»ºå¤åˆ¶ç”¨æˆ·</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@db01 3307<span class="o">]</span><span class="c1"># mysql -S /data/3307/mysql.sock </span>
</span></span><span class="line"><span class="cl">db01 <span class="o">[(</span>none<span class="o">)]</span>&gt;grant replication slave on *.* to repl@<span class="s1">&#39;10.0.0.%&#39;</span> identified by <span class="s1">&#39;123&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">db01 <span class="o">[(</span>none<span class="o">)]</span>&gt;select user,host from mysql.user<span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>å¤‡ä»½ä¸»åº“å¹¶æ¢å¤åˆ°ä»åº“</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@db01 3307<span class="o">]</span><span class="c1"># mysqldump -S /data/3307/mysql.sock -A --master-data=2 --single-transaction  -R --triggers &gt;/backup/full.sql</span>
</span></span><span class="line"><span class="cl">-- CHANGE MASTER TO <span class="nv">MASTER_LOG_FILE</span><span class="o">=</span><span class="s1">&#39;mysql-bin.000001&#39;</span>, <span class="nv">MASTER_LOG_POS</span><span class="o">=</span>653<span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@db01 3307<span class="o">]</span><span class="c1"># mysql -S /data/3308/mysql.sock</span>
</span></span><span class="line"><span class="cl">db01 <span class="o">[(</span>none<span class="o">)]</span>&gt;source /backup/full.sql
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>å‘ŠçŸ¥ä»åº“å…³é”®å¤åˆ¶ä¿¡æ¯</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ip port user  password  binlog position 
</span></span><span class="line"><span class="cl">[root@db01 3307]# mysql -S /data/3308/mysql.sock
</span></span><span class="line"><span class="cl">db01 [mysql]&gt;help change master to
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">CHANGE MASTER TO
</span></span><span class="line"><span class="cl">  MASTER_HOST=&#39;10.0.0.51&#39;,   #ä¸»åº“ipåœ°å€
</span></span><span class="line"><span class="cl">  MASTER_USER=&#39;repl&#39;,        #å¤åˆ¶ç”¨æˆ·
</span></span><span class="line"><span class="cl">  MASTER_PASSWORD=&#39;123&#39;,     #å¯†ç 
</span></span><span class="line"><span class="cl">  MASTER_PORT=3307,          #ç«¯å£
</span></span><span class="line"><span class="cl">  MASTER_LOG_FILE=&#39;mysql-bin.000001&#39;, #å¤åˆ¶binlogçš„èµ·å§‹ä½ç½®
</span></span><span class="line"><span class="cl">  MASTER_LOG_POS=653,        #èµ·å§‹ä½ç½®çš„poså¥½
</span></span><span class="line"><span class="cl">  MASTER_CONNECT_RETRY=10;   #å°è¯•è¿æ¥æ¬¡æ•°
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>å¼€å¯ä¸»ä»ä¸“ç”¨çº¿ç¨‹</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">start slave ;
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>æ£€æŸ¥å¤åˆ¶çŠ¶æ€</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">db01 [mysql]&gt;show slave  status \G
</span></span><span class="line"><span class="cl">Slave_IO_Running: Yes
</span></span><span class="line"><span class="cl">Slave_SQL_Running: Yes
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ä¸»ä»å¤åˆ¶åŸç†æè¿°ï¼š</strong></p>
<ul>
<li>1.change master to æ—¶ï¼Œip pot user password binlog positionå†™å…¥åˆ°master.infoè¿›è¡Œè®°å½•</li>
<li>2. start slave æ—¶ï¼Œä»åº“ä¼šå¯åŠ¨IOçº¿ç¨‹å’ŒSQLçº¿ç¨‹</li>
<li>3.IO_Tï¼Œè¯»å–master.infoä¿¡æ¯ï¼Œè·å–ä¸»åº“ä¿¡æ¯è¿æ¥ä¸»åº“</li>
<li>4. ä¸»åº“ä¼šç”Ÿæˆä¸€ä¸ªå‡†å¤‡binlog DUMPçº¿ç¨‹ï¼Œæ¥å“åº”ä»åº“</li>
<li>5. IO_Tæ ¹æ®master.infoè®°å½•çš„binlogæ–‡ä»¶åå’Œpositionå·ï¼Œè¯·æ±‚ä¸»åº“DUMPæœ€æ–°æ—¥å¿—</li>
<li>6. DUMPçº¿ç¨‹æ£€æŸ¥ä¸»åº“çš„binlogæ—¥å¿—ï¼Œå¦‚æœæœ‰æ–°çš„ï¼ŒTP(ä¼ é€)ç»™ä»ä»åº“çš„IO_T</li>
<li>7. IO_Tå°†æ”¶åˆ°çš„æ—¥å¿—å­˜å‚¨åˆ°äº†TCP/IP ç¼“å­˜ï¼Œç«‹å³è¿”å›ACKç»™ä¸»åº“ ï¼Œä¸»åº“å·¥ä½œå®Œæˆ</li>
<li>8.IO_Tå°†ç¼“å­˜ä¸­çš„æ•°æ®ï¼Œå­˜å‚¨åˆ°relay-logæ—¥å¿—æ–‡ä»¶,æ›´æ–°master.infoæ–‡ä»¶binlog æ–‡ä»¶åå’Œpostionï¼ŒIO_Tå·¥ä½œå®Œæˆ</li>
<li>9.SQL_Tè¯»å–relay-log.infoæ–‡ä»¶ï¼Œè·å–åˆ°ä¸Šæ¬¡æ‰§è¡Œåˆ°çš„relay-logçš„ä½ç½®ï¼Œä½œä¸ºèµ·ç‚¹ï¼Œå›æ”¾relay-log</li>
<li>10.SQL_Tå›æ”¾å®Œæˆä¹‹åï¼Œä¼šæ›´æ–°relay-log.infoæ–‡ä»¶ã€‚</li>
<li>11. relay-logä¼šæœ‰è‡ªåŠ¨æ¸…ç†çš„åŠŸèƒ½ã€‚</li>
<li>ç»†èŠ‚ï¼š</li>
<li>1.ä¸»åº“ä¸€æ—¦æœ‰æ–°çš„æ—¥å¿—ç”Ÿæˆï¼Œä¼šå‘é€â€œä¿¡å·â€ç»™binlog dump ï¼ŒIOçº¿ç¨‹å†è¯·æ±‚</li>
</ul>
<h3 id="5å»¶æ—¶ä»åº“">5ã€Â å»¶æ—¶ä»åº“</h3>
<p>æ˜¯æˆ‘ä»¬è®¤ä¸ºé…ç½®çš„ä¸€ç§ç‰¹æ®Šä»åº“.äººä¸ºé…ç½®ä»åº“å’Œä¸»åº“å»¶æ—¶Nå°æ—¶.</p>
<p><strong>ä¸ºä»€ä¹ˆè¦æœ‰å»¶æ—¶ä»ï¼Ÿ</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">æ•°æ®åº“æ•…éšœ?
</span></span><span class="line"><span class="cl">ç‰©ç†æŸå
</span></span><span class="line"><span class="cl">ä¸»ä»å¤åˆ¶éå¸¸æ“…é•¿è§£å†³ç‰©ç†æŸå.
</span></span><span class="line"><span class="cl">é€»è¾‘æŸå
</span></span><span class="line"><span class="cl">æ™®é€šä¸»ä»å¤åˆ¶æ²¡åŠæ³•è§£å†³é€»è¾‘æŸå
</span></span></code></pre></td></tr></table>
</div>
</div><p>é…ç½®å»¶æ—¶ä»åº“</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SQLçº¿ç¨‹å»¶æ—¶:æ•°æ®å·²ç»å†™å…¥relaylogä¸­äº†,SQLçº¿ç¨‹&#34;æ…¢ç‚¹&#34;è¿è¡Œ
</span></span><span class="line"><span class="cl">ä¸€èˆ¬ä¼ä¸šå»ºè®®3-6å°æ—¶,å…·ä½“çœ‹å…¬å¸è¿ç»´äººå‘˜å¯¹äºæ•…éšœçš„ååº”æ—¶é—´
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mysql&gt;stop slave;
</span></span><span class="line"><span class="cl">mysql&gt;CHANGE MASTER TO MASTER_DELAY = 300;
</span></span><span class="line"><span class="cl">mysql&gt;start slave;
</span></span><span class="line"><span class="cl">mysql&gt; show slave status \G
</span></span><span class="line"><span class="cl">SQL_Delay: 300
</span></span><span class="line"><span class="cl">SQL_Remaining_Delay: NULL
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>å»¶æ—¶ä»åº“åº”ç”¨</strong></p>
<blockquote>
<p>Â  Â  Â  Â  Â  Â  Â  1ä¸»1ä»,ä»åº“å»¶æ—¶5åˆ†é’Ÿ,ä¸»åº“è¯¯åˆ é™¤1ä¸ªåº“<br>
1. 5åˆ†é’Ÿä¹‹å†… ä¾¦æµ‹åˆ°è¯¯åˆ é™¤æ“ä½œ<br>
2. åœä»åº“SQLçº¿ç¨‹<br>
3. æˆªå–relaylog<br>
èµ·ç‚¹ :åœæ­¢SQLçº¿ç¨‹æ—¶,relayæœ€ååº”ç”¨ä½ç½®<br>
ç»ˆç‚¹:è¯¯åˆ é™¤ä¹‹å‰çš„position(GTID)<br>
4. æ¢å¤æˆªå–çš„æ—¥å¿—åˆ°ä»åº“<br>
5. ä»åº“èº«ä»½è§£é™¤,æ›¿ä»£ä¸»åº“å·¥ä½œ</p>
</blockquote>
<p><strong>æ•…éšœæ¨¡æ‹ŸåŠæ¢å¤</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1.ä¸»åº“æ•°æ®æ“ä½œ
</span></span><span class="line"><span class="cl">db01 [(none)]&gt;create database relay charset utf8;
</span></span><span class="line"><span class="cl">db01 [(none)]&gt;use relay
</span></span><span class="line"><span class="cl">db01 [relay]&gt;create table t1 (id int);
</span></span><span class="line"><span class="cl">db01 [relay]&gt;insert into t1 values(1);
</span></span><span class="line"><span class="cl">db01 [relay]&gt;drop database relay;
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">2. åœæ­¢ä»åº“SQLçº¿ç¨‹
</span></span><span class="line"><span class="cl">stop slave sql_thread;
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">3. æ‰¾relaylogçš„æˆªå–èµ·ç‚¹å’Œç»ˆç‚¹
</span></span><span class="line"><span class="cl">èµ·ç‚¹:
</span></span><span class="line"><span class="cl">Relay_Log_File: db01-relay-bin.000002
</span></span><span class="line"><span class="cl">Relay_Log_Pos: 482
</span></span><span class="line"><span class="cl">ç»ˆç‚¹:
</span></span><span class="line"><span class="cl">show relaylog events in &#39;db01-relay-bin.000002&#39;
</span></span><span class="line"><span class="cl">| db01-relay-bin.000002 | 1046 | Xid            |         7 |        2489 | COMMIT /* xid=144 */                  |
</span></span><span class="line"><span class="cl">| db01-relay-bin.000002 | 1077 | Anonymous_Gtid |         7 |        2554 | SET @@SESSION.GTID_NEXT= &#39;ANONYMOUS&#39;  |
</span></span><span class="line"><span class="cl">mysqlbinlog --start-position=482 --stop-position=1077  /data/3308/data/db01-relay-bin.000002&gt;/tmp/relay.sql
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">4.ä»åº“æ¢å¤relaylog
</span></span><span class="line"><span class="cl"><span class="nb">source</span> /tmp/relay.sql
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">5.ä»åº“èº«ä»½è§£é™¤
</span></span><span class="line"><span class="cl">db01 <span class="o">[</span>relay<span class="o">]</span>&gt;stop slave<span class="p">;</span>
</span></span><span class="line"><span class="cl">db01 <span class="o">[</span>relay<span class="o">]</span>&gt;reset slave all
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="6åŠåŒæ­¥å¤åˆ¶">6ã€åŠåŒæ­¥å¤åˆ¶</h3>
<p><strong>è§£å†³ä¸»ä»æ•°æ®ä¸€è‡´æ€§é—®é¢˜</strong></p>
<p>**Â åŠåŒæ­¥å¤åˆ¶å·¥ä½œåŸç†çš„å˜åŒ–**</p>
<ul>
<li>1. ä¸»åº“æ‰§è¡Œæ–°çš„äº‹åŠ¡,commitæ—¶,æ›´æ–° show master Â status\G ,è§¦å‘ä¸€ä¸ªä¿¡å·ç»™</li>
<li>2. binlog dump æ¥æ”¶åˆ°ä¸»åº“çš„ show master status\Gä¿¡æ¯,é€šçŸ¥ä»åº“æ—¥å¿—æ›´æ–°äº†</li>
<li>3. ä»åº“IOçº¿ç¨‹è¯·æ±‚æ–°çš„äºŒè¿›åˆ¶æ—¥å¿—äº‹ä»¶</li>
<li>4. ä¸»åº“ä¼šé€šè¿‡dumpçº¿ç¨‹ä¼ é€æ–°çš„æ—¥å¿—äº‹ä»¶,ç»™ä»åº“IOçº¿ç¨‹</li>
<li>5. ä»åº“IOçº¿ç¨‹æ¥æ”¶åˆ°binlogæ—¥å¿—,å½“æ—¥å¿—å†™å…¥åˆ°ç£ç›˜ä¸Šçš„relaylogæ–‡ä»¶æ—¶,ç»™ä¸»åº“ACK_receiverçº¿ç¨‹</li>
<li>6. ACK_receiverçº¿ç¨‹è§¦å‘ä¸€ä¸ªäº‹ä»¶,å‘Šè¯‰ä¸»åº“commitå¯ä»¥æˆåŠŸäº†</li>
<li>7. å¦‚æœACKè¾¾åˆ°äº†æˆ‘ä»¬é¢„è®¾å€¼çš„è¶…æ—¶æ—¶é—´,åŠåŒæ­¥å¤åˆ¶ä¼šåˆ‡æ¢ä¸ºåŸå§‹çš„å¼‚æ­¥å¤åˆ¶.</li>
</ul>
<p><strong>é…ç½®åŠåŒæ­¥å¤åˆ¶</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">åŠ è½½æ’ä»¶
</span></span><span class="line"><span class="cl">ä¸»:
</span></span><span class="line"><span class="cl">INSTALL PLUGIN rpl_semi_sync_master SONAME &#39;semisync_master.so&#39;;
</span></span><span class="line"><span class="cl">ä»:
</span></span><span class="line"><span class="cl">INSTALL PLUGIN rpl_semi_sync_slave SONAME &#39;semisync_slave.so&#39;;
</span></span><span class="line"><span class="cl">æŸ¥çœ‹æ˜¯å¦åŠ è½½æˆåŠŸ:
</span></span><span class="line"><span class="cl">show plugins;
</span></span><span class="line"><span class="cl">å¯åŠ¨:
</span></span><span class="line"><span class="cl">ä¸»:
</span></span><span class="line"><span class="cl">SET GLOBAL rpl_semi_sync_master_enabled = 1;
</span></span><span class="line"><span class="cl">ä»:
</span></span><span class="line"><span class="cl">SET GLOBAL rpl_semi_sync_slave_enabled = 1;
</span></span><span class="line"><span class="cl">é‡å¯ä»åº“ä¸Šçš„IOçº¿ç¨‹
</span></span><span class="line"><span class="cl">STOP SLAVE IO_THREAD;
</span></span><span class="line"><span class="cl">START SLAVE IO_THREAD;
</span></span><span class="line"><span class="cl">æŸ¥çœ‹æ˜¯å¦åœ¨è¿è¡Œ
</span></span><span class="line"><span class="cl">ä¸»:
</span></span><span class="line"><span class="cl">show status like &#39;Rpl_semi_sync_master_status&#39;;
</span></span><span class="line"><span class="cl">ä»:
</span></span><span class="line"><span class="cl">show status like &#39;Rpl_semi_sync_slave_status&#39;;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="7è¿‡æ»¤å¤åˆ¶">7ã€è¿‡æ»¤å¤åˆ¶</h3>
<p>ä¸»åº“ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">show master status;
</span></span><span class="line"><span class="cl">Binlog_Do_DB
</span></span><span class="line"><span class="cl">Binlog_Ignore_DB 
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»åº“ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">show slave status\G
</span></span><span class="line"><span class="cl">Replicate_Do_DB: 
</span></span><span class="line"><span class="cl">Replicate_Ignore_DB: 
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>å®ç°è¿‡ç¨‹</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">mysqldump -S /data/3307/mysql.sock -A --master-data=2 --single-transaction  -R --triggers &gt;/backup/full.sql
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">vim  /backup/full.sql
</span></span><span class="line"><span class="cl">-- CHANGE MASTER TO MASTER_LOG_FILE=&#39;mysql-bin.000002&#39;, MASTER_LOG_POS=154;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[root@db01 ~]# mysql -S /data/3309/mysql.sock 
</span></span><span class="line"><span class="cl">source /backup/full.sql
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">CHANGE MASTER TO
</span></span><span class="line"><span class="cl">MASTER_HOST=&#39;10.0.0.51&#39;,
</span></span><span class="line"><span class="cl">MASTER_USER=&#39;repl&#39;,
</span></span><span class="line"><span class="cl">MASTER_PASSWORD=&#39;123&#39;,
</span></span><span class="line"><span class="cl">MASTER_PORT=3307,
</span></span><span class="line"><span class="cl">MASTER_LOG_FILE=&#39;mysql-bin.000002&#39;,
</span></span><span class="line"><span class="cl">MASTER_LOG_POS=154,
</span></span><span class="line"><span class="cl">MASTER_CONNECT_RETRY=10;
</span></span><span class="line"><span class="cl">start  slave;
</span></span><span class="line"><span class="cl">[root@db01 ~]# vim /data/3309/my.cnf 
</span></span><span class="line"><span class="cl">replicate_do_db=ppt
</span></span><span class="line"><span class="cl">replicate_do_db=word
</span></span><span class="line"><span class="cl">[root@db01 ~]# systemctl restart mysqld3309
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ä¸»åº“ï¼š
</span></span><span class="line"><span class="cl">Master [(none)]&gt;create database word;
</span></span><span class="line"><span class="cl">Query OK, 1 row affected (0.00 sec)
</span></span><span class="line"><span class="cl">Master [(none)]&gt;create database ppt;
</span></span><span class="line"><span class="cl">Query OK, 1 row affected (0.00 sec)
</span></span><span class="line"><span class="cl">Master [(none)]&gt;create database excel;
</span></span><span class="line"><span class="cl">Query OK, 1 row affected (0.01 sec)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="8gtidå¤åˆ¶">8ã€GTIDå¤åˆ¶</h3>
<p>GTIDä»‹ç»</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">GTID(Global Transaction ID)æ˜¯å¯¹äºä¸€ä¸ªå·²æäº¤äº‹åŠ¡çš„å”¯ä¸€ç¼–å·ï¼Œå¹¶ä¸”æ˜¯ä¸€ä¸ªå…¨å±€(ä¸»ä»å¤åˆ¶)å”¯ä¸€çš„ç¼–å·ã€‚
</span></span><span class="line"><span class="cl">å®ƒçš„å®˜æ–¹å®šä¹‰å¦‚ä¸‹ï¼š
</span></span><span class="line"><span class="cl">GTID = source_id ï¼štransaction_id
</span></span><span class="line"><span class="cl">7E11FA47-31CA-19E1-9E56-C43AA21293967:29
</span></span><span class="line"><span class="cl">ä»€ä¹ˆæ˜¯sever_uuidï¼Œå’ŒServer-id åŒºåˆ«ï¼Ÿ
</span></span><span class="line"><span class="cl">æ ¸å¿ƒç‰¹æ€§: å…¨å±€å”¯ä¸€,å…·å¤‡å¹‚ç­‰æ€§
</span></span></code></pre></td></tr></table>
</div>
</div><p>GTIDæ ¸å¿ƒå‚æ•°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">gtid-mode=on
</span></span><span class="line"><span class="cl">enforce-gtid-consistency=true
</span></span><span class="line"><span class="cl">log-slave-updates=1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gtid-mode=on                        --å¯ç”¨gtidç±»å‹ï¼Œå¦åˆ™å°±æ˜¯æ™®é€šçš„å¤åˆ¶æ¶æ„
</span></span><span class="line"><span class="cl">enforce-gtid-consistency=true               --å¼ºåˆ¶GTIDçš„ä¸€è‡´æ€§
</span></span><span class="line"><span class="cl">log-slave-updates=1                 --slaveæ›´æ–°æ˜¯å¦è®°å…¥æ—¥å¿—
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>GTIDå¤åˆ¶é…ç½®è¿‡ç¨‹ï¼š</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ä¸»åº“db01ï¼š
</span></span><span class="line"><span class="cl">cat &gt; /etc/my.cnf &lt;&lt;EOF
</span></span><span class="line"><span class="cl">[mysqld]
</span></span><span class="line"><span class="cl">basedir=/data/mysql/
</span></span><span class="line"><span class="cl">datadir=/data/mysql/data
</span></span><span class="line"><span class="cl">socket=/tmp/mysql.sock
</span></span><span class="line"><span class="cl">server_id=51
</span></span><span class="line"><span class="cl">port=3306
</span></span><span class="line"><span class="cl">secure-file-priv=/tmp
</span></span><span class="line"><span class="cl">autocommit=0
</span></span><span class="line"><span class="cl">log_bin=/data/binlog/mysql-bin
</span></span><span class="line"><span class="cl">binlog_format=row
</span></span><span class="line"><span class="cl">gtid-mode=on
</span></span><span class="line"><span class="cl">enforce-gtid-consistency=true
</span></span><span class="line"><span class="cl">log-slave-updates=1
</span></span><span class="line"><span class="cl">[mysql]
</span></span><span class="line"><span class="cl">prompt=db01 [\\d]&gt;
</span></span><span class="line"><span class="cl">EOF
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">slave1(db02)ï¼š
</span></span><span class="line"><span class="cl">cat &gt; /etc/my.cnf &lt;&lt;EOF
</span></span><span class="line"><span class="cl">[mysqld]
</span></span><span class="line"><span class="cl">basedir=/data/mysql
</span></span><span class="line"><span class="cl">datadir=/data/mysql/data
</span></span><span class="line"><span class="cl">socket=/tmp/mysql.sock
</span></span><span class="line"><span class="cl">server_id=52
</span></span><span class="line"><span class="cl">port=3306
</span></span><span class="line"><span class="cl">secure-file-priv=/tmp
</span></span><span class="line"><span class="cl">autocommit=0
</span></span><span class="line"><span class="cl">log_bin=/data/binlog/mysql-bin
</span></span><span class="line"><span class="cl">binlog_format=row
</span></span><span class="line"><span class="cl">gtid-mode=on
</span></span><span class="line"><span class="cl">enforce-gtid-consistency=true
</span></span><span class="line"><span class="cl">log-slave-updates=1
</span></span><span class="line"><span class="cl">[mysql]
</span></span><span class="line"><span class="cl">prompt=db02 [\\d]&gt;
</span></span><span class="line"><span class="cl">EOF
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">slave2(db03)ï¼š
</span></span><span class="line"><span class="cl">cat &gt; /etc/my.cnf &lt;&lt;EOF
</span></span><span class="line"><span class="cl">[mysqld]
</span></span><span class="line"><span class="cl">basedir=/data/mysql
</span></span><span class="line"><span class="cl">datadir=/data/mysql/data
</span></span><span class="line"><span class="cl">socket=/tmp/mysql.sock
</span></span><span class="line"><span class="cl">server_id=53
</span></span><span class="line"><span class="cl">port=3306
</span></span><span class="line"><span class="cl">secure-file-priv=/tmp
</span></span><span class="line"><span class="cl">autocommit=0
</span></span><span class="line"><span class="cl">log_bin=/data/binlog/mysql-bin
</span></span><span class="line"><span class="cl">binlog_format=row
</span></span><span class="line"><span class="cl">gtid-mode=on
</span></span><span class="line"><span class="cl">enforce-gtid-consistency=true
</span></span><span class="line"><span class="cl">log-slave-updates=1
</span></span><span class="line"><span class="cl">[mysql]
</span></span><span class="line"><span class="cl">prompt=db03 [\\d]&gt;
</span></span><span class="line"><span class="cl">EOF
</span></span></code></pre></td></tr></table>
</div>
</div><p>åˆå§‹åŒ–æ•°æ®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">mysqld --initialize-insecure --user=mysql --basedir=/data/mysql  --datadir=/data/mysql/data 
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯åŠ¨æ•°æ®åº“</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/etc/init.d/mysqld start
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ„å»ºä¸»ä»</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">master:51
</span></span><span class="line"><span class="cl">slave:52,53
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">51:
</span></span><span class="line"><span class="cl">grant replication slave  on *.* to repl@&#39;10.0.0.%&#39; identified by &#39;123&#39;;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">52\53:
</span></span><span class="line"><span class="cl">change master to 
</span></span><span class="line"><span class="cl">master_host=&#39;10.0.0.51&#39;,
</span></span><span class="line"><span class="cl">master_user=&#39;repl&#39;,
</span></span><span class="line"><span class="cl">master_password=&#39;123&#39; ,
</span></span><span class="line"><span class="cl">MASTER_AUTO_POSITION=1;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">start slave;
</span></span></code></pre></td></tr></table>
</div>
</div><p>GTID ä»åº“è¯¯å†™å…¥æ“ä½œå¤„ç†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">æŸ¥çœ‹ç›‘æ§ä¿¡æ¯:
</span></span><span class="line"><span class="cl">Last_SQL_Error: Error &#39;Can&#39;t create database &#39;oldboy&#39;; database exists&#39; on query. Default database: &#39;oldboy&#39;. Query: &#39;create database oldboy&#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Retrieved_Gtid_Set: 71bfa52e-4aae-11e9-ab8c-000c293b577e:1-3
</span></span><span class="line"><span class="cl">Executed_Gtid_Set:  71bfa52e-4aae-11e9-ab8c-000c293b577e:1-2,
</span></span><span class="line"><span class="cl">7ca4a2b7-4aae-11e9-859d-000c298720f6:1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">æ³¨å…¥ç©ºäº‹ç‰©çš„æ–¹æ³•ï¼š
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">stop slave;
</span></span><span class="line"><span class="cl">set gtid_next=&#39;99279e1e-61b7-11e9-a9fc-000c2928f5dd:3&#39;;
</span></span><span class="line"><span class="cl">begin;commit;
</span></span><span class="line"><span class="cl">set gtid_next=&#39;AUTOMATIC&#39;;
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">è¿™é‡Œçš„xxxxx:N ä¹Ÿå°±æ˜¯ä½ çš„slave sql threadæŠ¥é”™çš„GTIDï¼Œæˆ–è€…è¯´æ˜¯ä½ æƒ³è¦è·³è¿‡çš„GTIDã€‚
</span></span><span class="line"><span class="cl">æœ€å¥½çš„è§£å†³æ–¹æ¡ˆï¼šé‡æ–°æ„å»ºä¸»ä»ç¯å¢ƒ
</span></span></code></pre></td></tr></table>
</div>
</div><p>GTID å¤åˆ¶å’Œæ™®é€šå¤åˆ¶çš„åŒºåˆ«</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">CHANGE MASTER TO
</span></span><span class="line"><span class="cl">MASTER_HOST=&#39;10.0.0.51&#39;,
</span></span><span class="line"><span class="cl">MASTER_USER=&#39;repl&#39;,
</span></span><span class="line"><span class="cl">MASTER_PASSWORD=&#39;123&#39;,
</span></span><span class="line"><span class="cl">MASTER_PORT=3307,
</span></span><span class="line"><span class="cl">MASTER_LOG_FILE=&#39;mysql-bin.000001&#39;,
</span></span><span class="line"><span class="cl">MASTER_LOG_POS=444,
</span></span><span class="line"><span class="cl">MASTER_CONNECT_RETRY=10;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">change master to 
</span></span><span class="line"><span class="cl">master_host=&#39;10.0.0.51&#39;,
</span></span><span class="line"><span class="cl">master_user=&#39;repl&#39;,
</span></span><span class="line"><span class="cl">master_password=&#39;123&#39; ,
</span></span><span class="line"><span class="cl">MASTER_AUTO_POSITION=1;
</span></span><span class="line"><span class="cl">start slave;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ï¼ˆ0ï¼‰åœ¨ä¸»ä»å¤åˆ¶ç¯å¢ƒä¸­ï¼Œä¸»åº“å‘ç”Ÿè¿‡çš„äº‹åŠ¡ï¼Œåœ¨å…¨å±€éƒ½æ˜¯ç”±å”¯ä¸€GTIDè®°å½•çš„ï¼Œæ›´æ–¹ä¾¿Failover
</span></span><span class="line"><span class="cl">ï¼ˆ1ï¼‰é¢å¤–åŠŸèƒ½å‚æ•°ï¼ˆ3ä¸ªï¼‰
</span></span><span class="line"><span class="cl">ï¼ˆ2ï¼‰change master to çš„æ—¶å€™ä¸å†éœ€è¦binlog æ–‡ä»¶åå’Œpositionå·,MASTER_AUTO_POSITION=1;
</span></span><span class="line"><span class="cl">ï¼ˆ3ï¼‰åœ¨å¤åˆ¶è¿‡ç¨‹ä¸­ï¼Œä»åº“ä¸å†ä¾èµ–master.infoæ–‡ä»¶ï¼Œè€Œæ˜¯ç›´æ¥è¯»å–æœ€åä¸€ä¸ªrelaylogçš„ GTIDå·
</span></span><span class="line"><span class="cl">ï¼ˆ4ï¼‰ mysqldumpå¤‡ä»½æ—¶ï¼Œé»˜è®¤ä¼šå°†å¤‡ä»½ä¸­åŒ…å«çš„äº‹åŠ¡æ“ä½œï¼Œä»¥ä»¥ä¸‹æ–¹å¼
</span></span><span class="line"><span class="cl">    SET @@GLOBAL.GTID_PURGED=&#39;8c49d7ec-7e78-11e8-9638-000c29ca725d:1&#39;;
</span></span><span class="line"><span class="cl">    å‘Šè¯‰ä»åº“ï¼Œæˆ‘çš„å¤‡ä»½ä¸­å·²ç»æœ‰ä»¥ä¸Šäº‹åŠ¡ï¼Œä½ å°±ä¸ç”¨è¿è¡Œäº†ï¼Œç›´æ¥ä»ä¸‹ä¸€ä¸ªGTIDå¼€å§‹è¯·æ±‚binlogå°±è¡Œã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><p>Â </p>
<h3 id="9-ä¸»ä»æ•…éšœç›‘æ§åˆ†æå¤„ç†">9. ä¸»ä»æ•…éšœç›‘æ§\åˆ†æ\å¤„ç†</h3>
<p>ä¸»åº“:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">show full processlist<span class="p">;</span>
</span></span><span class="line"><span class="cl">æ¯ä¸ªä»åº“éƒ½ä¼šæœ‰ä¸€è¡Œdumpç›¸å…³çš„ä¿¡æ¯
</span></span><span class="line"><span class="cl">HOSTS: 
</span></span><span class="line"><span class="cl">db01:47176
</span></span><span class="line"><span class="cl">State:
</span></span><span class="line"><span class="cl">Master has sent all binlog to slave<span class="p">;</span> waiting <span class="k">for</span> more updates
</span></span><span class="line"><span class="cl">å¦‚æœç°å®éä»¥ä¸Šä¿¡æ¯,è¯´æ˜ä¸»ä»ä¹‹é—´çš„å…³ç³»å‡ºç°äº†é—®é¢˜    
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»åº“:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">db01 [(none)]&gt;show slave status \G
</span></span><span class="line"><span class="cl">*************************** 1. row ***************************
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸»åº“ç›¸å…³ä¿¡æ¯ç›‘æ§</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Master_Host: 10.0.0.51
</span></span><span class="line"><span class="cl">Master_User: repl
</span></span><span class="line"><span class="cl">Master_Port: 3307
</span></span><span class="line"><span class="cl">Master_Log_File: mysql-bin.000005
</span></span><span class="line"><span class="cl">Read_Master_Log_Pos: 444
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»åº“ä¸­ç»§æ—¥å¿—çš„åº”ç”¨çŠ¶æ€</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Relay_Log_File: db01-relay-bin.000002
</span></span><span class="line"><span class="cl">Relay_Log_Pos: 485
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»åº“å¤åˆ¶çº¿ç¨‹æœ‰å…³çš„çŠ¶æ€</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Slave_IO_Running: Yes
</span></span><span class="line"><span class="cl">Slave_SQL_Running: Yes
</span></span><span class="line"><span class="cl">Last_IO_Errno: 0
</span></span><span class="line"><span class="cl">Last_IO_Error: 
</span></span><span class="line"><span class="cl">Last_SQL_Errno: 0
</span></span><span class="line"><span class="cl">Last_SQL_Error: 
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿‡æ»¤å¤åˆ¶æœ‰å…³çš„çŠ¶æ€</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Replicate_Do_DB: 
</span></span><span class="line"><span class="cl">Replicate_Ignore_DB: 
</span></span><span class="line"><span class="cl">Replicate_Do_Table: 
</span></span><span class="line"><span class="cl">Replicate_Ignore_Table: 
</span></span><span class="line"><span class="cl">Replicate_Wild_Do_Table: 
</span></span><span class="line"><span class="cl">Replicate_Wild_Ignore_Table: 
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸»ä»å»¶æ—¶ç›¸å…³çŠ¶æ€(éäººä¸º)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Seconds_Behind_Master: 0
</span></span></code></pre></td></tr></table>
</div>
</div><p>å»¶æ—¶ä»åº“æœ‰å…³çš„çŠ¶æ€(äººä¸º)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SQL_Delay: 0
</span></span><span class="line"><span class="cl">SQL_Remaining_Delay: NULL
</span></span></code></pre></td></tr></table>
</div>
</div><p>GTID å¤åˆ¶æœ‰å…³çš„çŠ¶æ€</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Retrieved_Gtid_Set: 
</span></span><span class="line"><span class="cl">Executed_Gtid_Set: 
</span></span><span class="line"><span class="cl">Auto_Position: 0
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ä¸»ä»å¤åˆ¶æ•…éšœåˆ†æ">ä¸»ä»å¤åˆ¶æ•…éšœåˆ†æ</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">(1) ç”¨æˆ· å¯†ç   IP  port
</span></span><span class="line"><span class="cl">Last_IO_Error: error reconnecting to master &#39;repl@10.0.0.51:3307&#39; - retry-time: 10  retries: 7
</span></span><span class="line"><span class="cl">[root@db01 ~]# mysql -urepl  -p123333  -h 10.0.0.51 -P 3307
</span></span><span class="line"><span class="cl">ERROR 1045 (28000): Access denied for user &#39;repl&#39;@&#39;db01&#39; (using password: YES)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">åŸå› :
</span></span><span class="line"><span class="cl">å¯†ç é”™è¯¯ 
</span></span><span class="line"><span class="cl">ç”¨æˆ·é”™è¯¯ 
</span></span><span class="line"><span class="cl">skip_name_resolve
</span></span><span class="line"><span class="cl">åœ°å€é”™è¯¯
</span></span><span class="line"><span class="cl">ç«¯å£
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¤„ç†æ–¹æ³•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">stop  slave  
</span></span><span class="line"><span class="cl">reset slave all 
</span></span><span class="line"><span class="cl">change master to 
</span></span><span class="line"><span class="cl">start slave
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ä¸»åº“è¿æ¥æ•°ä¸Šçº¿,æˆ–è€…æ˜¯ä¸»åº“å¤ªç¹å¿™</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">show slave  staus \G 
</span></span><span class="line"><span class="cl">Last_IO_Errno: 1040
</span></span><span class="line"><span class="cl">Last_IO_Error: error reconnecting to master &#39;repl@10.0.0.51:3307&#39; - retry-time: 10  retries: 7
</span></span><span class="line"><span class="cl">å¤„ç†æ€è·¯:
</span></span><span class="line"><span class="cl">æ‹¿å¤åˆ¶ç”¨æˆ·,æ‰‹å·¥è¿æ¥ä¸€ä¸‹
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[root@db01 ~]# mysql -urepl -p123 -h 10.0.0.51 -P 3307 
</span></span><span class="line"><span class="cl">mysql: [Warning] Using a password on the command line interface can be insecure.
</span></span><span class="line"><span class="cl">ERROR 1040 (HY000): Too many connections
</span></span><span class="line"><span class="cl">å¤„ç†æ–¹æ³•:
</span></span><span class="line"><span class="cl">db01 [(none)]&gt;set global max_connections=300;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">(3) é˜²ç«å¢™,ç½‘ç»œä¸é€š
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>è¯·æ±‚äºŒè¿›åˆ¶æ—¥å¿—</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ä¸»åº“ç¼ºå¤±æ—¥å¿—
</span></span><span class="line"><span class="cl">ä»åº“æ–¹é¢,äºŒè¿›åˆ¶æ—¥å¿—ä½ç½®ç‚¹ä¸å¯¹
</span></span><span class="line"><span class="cl">Last_IO_Error: Got fatal error 1236 from master when reading data from binary log: &#39;could not find next log; the first event &#39;mysql-bin.000001&#39; at 154, the last event read from &#39;/data/3307/data/mysql-bin.000002&#39; at 154, the last byte read from &#39;/data/3307/data/mysql-bin.000002&#39; at 154.&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">æ³¨æ„: åœ¨ä¸»ä»å¤åˆ¶ç¯å¢ƒä¸­,ä¸¥ä»¤ç¦æ­¢ä¸»åº“ä¸­reset master; å¯ä»¥é€‰æ‹©expire è¿›è¡Œå®šæœŸæ¸…ç†ä¸»åº“äºŒè¿›åˆ¶æ—¥å¿—
</span></span><span class="line"><span class="cl">è§£å†³æ–¹æ¡ˆ:
</span></span><span class="line"><span class="cl">é‡æ–°æ„å»ºä¸»ä»
</span></span></code></pre></td></tr></table>
</div>
</div><p>**Â SQL çº¿ç¨‹æ•…éšœ**</p>
<p>SQLçº¿ç¨‹åŠŸèƒ½ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">(1)è¯»å†™relay-log.info 
</span></span><span class="line"><span class="cl">(2)relay-logæŸå,æ–­èŠ‚,æ‰¾ä¸åˆ°
</span></span><span class="line"><span class="cl">(3)æ¥æ”¶åˆ°çš„SQLæ— æ³•æ‰§è¡Œ
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>å¯¼è‡´SQLçº¿ç¨‹æ•…éšœåŸå› åˆ†æï¼š</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1. ç‰ˆæœ¬å·®å¼‚ï¼Œå‚æ•°è®¾å®šä¸åŒï¼Œæ¯”å¦‚ï¼šæ•°æ®ç±»å‹çš„å·®å¼‚ï¼ŒSQL_MODEå½±å“
</span></span><span class="line"><span class="cl">2.è¦åˆ›å»ºçš„æ•°æ®åº“å¯¹è±¡,å·²ç»å­˜åœ¨
</span></span><span class="line"><span class="cl">3.è¦åˆ é™¤æˆ–ä¿®æ”¹çš„å¯¹è±¡ä¸å­˜åœ¨  
</span></span><span class="line"><span class="cl">4.DMLè¯­å¥ä¸ç¬¦åˆè¡¨å®šä¹‰åŠçº¦æŸæ—¶.  
</span></span><span class="line"><span class="cl">å½’æ ¹æ­åº•çš„åŸå› éƒ½æ˜¯ç”±äºä»åº“å‘ç”Ÿäº†å†™å…¥æ“ä½œ.
</span></span><span class="line"><span class="cl">Last_SQL_Error: Error &#39;Can&#39;t create database &#39;db&#39;; database exists&#39; on query. Default database: &#39;db&#39;. Query: &#39;create database db&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¤„ç†æ–¹æ³•(ä»¥ä»åº“ä¸ºæ ¸å¿ƒçš„å¤„ç†æ–¹æ¡ˆ)ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">æ–¹æ³•ä¸€ï¼š
</span></span><span class="line"><span class="cl">stop slave; 
</span></span><span class="line"><span class="cl">set global sql_slave_skip_counter = 1;
</span></span><span class="line"><span class="cl">#å°†åŒæ­¥æŒ‡é’ˆå‘ä¸‹ç§»åŠ¨ä¸€ä¸ªï¼Œå¦‚æœå¤šæ¬¡ä¸åŒæ­¥ï¼Œå¯ä»¥é‡å¤æ“ä½œã€‚
</span></span><span class="line"><span class="cl">start slave;
</span></span><span class="line"><span class="cl">æ–¹æ³•äºŒï¼š
</span></span><span class="line"><span class="cl">/etc/my.cnf
</span></span><span class="line"><span class="cl">slave-skip-errors = 1032,1062,1007
</span></span><span class="line"><span class="cl">å¸¸è§é”™è¯¯ä»£ç :
</span></span><span class="line"><span class="cl">1007:å¯¹è±¡å·²å­˜åœ¨
</span></span><span class="line"><span class="cl">1032:æ— æ³•æ‰§è¡ŒDML
</span></span><span class="line"><span class="cl">1062:ä¸»é”®å†²çª,æˆ–çº¦æŸå†²çª
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ä½†æ˜¯ï¼Œä»¥ä¸Šæ“ä½œæœ‰æ—¶æ˜¯æœ‰é£é™©çš„ï¼Œæœ€å®‰å…¨çš„åšæ³•å°±æ˜¯é‡æ–°æ„å»ºä¸»ä»ã€‚æŠŠæ¡ä¸€ä¸ªåŸåˆ™,ä¸€åˆ‡ä»¥ä¸»åº“ä¸ºä¸».
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸€åŠ³æ°¸é€¸çš„æ–¹æ³•:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">(1) å¯ä»¥è®¾ç½®ä»åº“åªè¯».
</span></span><span class="line"><span class="cl">db01 [(none)]&gt;show variables like &#39;%read_only%&#39;;
</span></span><span class="line"><span class="cl">æ³¨æ„ï¼š
</span></span><span class="line"><span class="cl">åªä¼šå½±å“åˆ°æ™®é€šç”¨æˆ·ï¼Œå¯¹ç®¡ç†å‘˜ç”¨æˆ·æ— æ•ˆã€‚
</span></span><span class="line"><span class="cl">(2)åŠ ä¸­é—´ä»¶
</span></span><span class="line"><span class="cl">è¯»å†™åˆ†ç¦»ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸»ä»å»¶æ—¶ç›‘æ§åŠåŸå› Â </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ä¸»åº“åšäº†ä¿®æ”¹æ“ä½œ,ä»åº“æ¯”è¾ƒé•¿æ—¶é—´æ‰èƒ½è¿½ä¸Š.
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¤–åœ¨å› ç´ </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ç½‘ç»œ 
</span></span><span class="line"><span class="cl">ä¸»ä»ç¡¬ä»¶å·®å¼‚è¾ƒå¤§
</span></span><span class="line"><span class="cl">ç‰ˆæœ¬å·®å¼‚
</span></span><span class="line"><span class="cl">å‚æ•°å› ç´ 
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸»åº“</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">(1) äºŒè¿›åˆ¶æ—¥å¿—å†™å…¥ä¸åŠæ—¶
</span></span><span class="line"><span class="cl">[rep]&gt;select @@sync_binlog;
</span></span><span class="line"><span class="cl">(2) CRçš„ä¸»ä»å¤åˆ¶ä¸­,binlog_dumpçº¿ç¨‹,äº‹ä»¶ä¸ºå•å…ƒ,ä¸²è¡Œä¼ é€äºŒè¿›åˆ¶æ—¥å¿—(5.6 5.5)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">1. ä¸»åº“å¹¶å‘äº‹åŠ¡é‡å¤§,ä¸»åº“å¯ä»¥å¹¶è¡Œ,ä¼ é€æ—¶æ˜¯ä¸²è¡Œ
</span></span><span class="line"><span class="cl">2. ä¸»åº“å‘ç”Ÿäº†å¤§äº‹åŠ¡,ç”±äºæ˜¯ä¸²è¡Œä¼ é€,ä¼šäº§ç”Ÿé˜»å¡åç»­çš„äº‹åŠ¡.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">è§£å†³æ–¹æ¡ˆ:
</span></span><span class="line"><span class="cl">1. 5.6 å¼€å§‹,å¼€å¯GTID,å®ç°äº†GC(group commit)æœºåˆ¶,å¯ä»¥å¹¶è¡Œä¼ è¾“æ—¥å¿—ç»™ä»åº“IO
</span></span><span class="line"><span class="cl">2. 5.7 å¼€å§‹,ä¸å¼€å¯GTID,ä¼šè‡ªåŠ¨ç»´æŠ¤åŒ¿åçš„GTID,ä¹Ÿèƒ½å®ç°GC,æˆ‘ä»¬å»ºè®®è¿˜æ˜¯è®¤ä¸ºå¼€å¯GTID
</span></span><span class="line"><span class="cl">3. å¤§äº‹åŠ¡æ‹†æˆå¤šä¸ªå°äº‹åŠ¡,å¯ä»¥æœ‰æ•ˆçš„å‡å°‘ä¸»ä»å»¶æ—¶.
</span></span></code></pre></td></tr></table>
</div>
</div><p>Â ä»åº“</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SQLçº¿ç¨‹å¯¼è‡´çš„ä¸»ä»å»¶æ—¶
</span></span><span class="line"><span class="cl">åœ¨CRå¤åˆ¶æƒ…å†µä¸‹: ä»åº“é»˜è®¤æƒ…å†µä¸‹åªæœ‰ä¸€ä¸ªSQL,åªèƒ½ä¸²è¡Œå›æ”¾äº‹åŠ¡SQL
</span></span><span class="line"><span class="cl">1. ä¸»åº“å¦‚æœå¹¶å‘äº‹åŠ¡é‡è¾ƒå¤§,ä»åº“åªèƒ½ä¸²è¡Œå›æ”¾
</span></span><span class="line"><span class="cl">2. ä¸»åº“å‘ç”Ÿäº†å¤§äº‹åŠ¡,ä¼šé˜»å¡åç»­çš„æ‰€æœ‰çš„äº‹åŠ¡çš„è¿è¡Œ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">è§£å†³æ–¹æ¡ˆ:
</span></span><span class="line"><span class="cl">1. 5.6 ç‰ˆæœ¬å¼€å¯GTIDä¹‹å,åŠ å…¥äº†SQLå¤šçº¿ç¨‹çš„ç‰¹æ€§,ä½†æ˜¯åªèƒ½é’ˆå¯¹ä¸åŒåº“(database)ä¸‹çš„äº‹åŠ¡è¿›è¡Œå¹¶å‘å›æ”¾.
</span></span><span class="line"><span class="cl">2. 5.7 ç‰ˆæœ¬å¼€å§‹GTIDä¹‹å,åœ¨SQLæ–¹é¢,æä¾›äº†åŸºäºé€»è¾‘æ—¶é’Ÿ(logical_clock),binlogåŠ å…¥äº†seq_noæœºåˆ¶,
</span></span><span class="line"><span class="cl">çœŸæ­£å®ç°äº†åŸºäºäº‹åŠ¡çº§åˆ«çš„å¹¶å‘å›æ”¾,è¿™ç§æŠ€æœ¯æˆ‘ä»¬æŠŠå®ƒç§°ä¹‹ä¸ºMTS(enhanced multi-threaded slave).
</span></span><span class="line"><span class="cl">3. å¤§äº‹åŠ¡æ‹†æˆå¤šä¸ªå°äº‹åŠ¡,å¯ä»¥æœ‰æ•ˆçš„å‡å°‘ä¸»ä»å»¶æ—¶.
</span></span><span class="line"><span class="cl">[https://dev.mysql.com/worklog/task/?id=6314]
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/../../image/20200609173050827.png"
	
	
	
	loading="lazy"
	
	
></p>
<p><img src="/../../image/20200609173240393.png"
	
	
	
	loading="lazy"
	
	
></p>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">æ•°æ®åº“</a>
        
            <a href="/tags/linux/">linux</a>
        
            <a href="/tags/mysql/">mysql</a>
        
            <a href="/tags/%E4%B8%BB%E4%BB%8E%E5%90%8C%E6%AD%A5/">ä¸»ä»åŒæ­¥</a>
        
            <a href="/tags/gtid/">GTID</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>æœªæ¥çš„ä½ ï¼Œä¼šæ„Ÿè°¢ä»Šå¤©ä»åœ¨åŠªåŠ›å¥‹æ–—çš„ä½ </span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/202101181952/">
        
        
            <div class="article-image">
                
                    <img src="/../../title_pic/58.jpg" loading="lazy" data-key="202101181952" data-hash="/../../title_pic/58.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">MySQLå®¹å™¨éƒ¨ç½²åŠæ•°æ®æŒä¹…åŒ–ï¼ˆä¸»ä»å¤åˆ¶ï¼‰</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/202006091628/">
        
        
            <div class="article-image">
                
                    <img src="/../../title_pic/02.jpg" loading="lazy" data-key="202006091628" data-hash="/../../title_pic/02.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">MySQLäºŒè¿›åˆ¶å®‰è£…ï¼ˆç‰ˆæœ¬ï¼š5.7.26ï¼‰</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/202005281718/">
        
        
            <div class="article-image">
                
                    <img src="/../../title_pic/29.jpg" loading="lazy" data-key="202005281718" data-hash="/../../title_pic/29.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">MySQL--å¤‡ä»½æ¢å¤ã€Mysqdump&#43;xtrabackupï¼ˆXBKï¼‰ã€‘</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/202005271751/">
        
        
            <div class="article-image">
                
                    <img src="/../../title_pic/32.jpg" loading="lazy" data-key="202005271751" data-hash="/../../title_pic/32.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Mysqlæ—¥å¿—åˆ†æï¼ˆé”™è¯¯æ—¥å¿—ï¼ŒBinlogæ—¥å¿—ï¼Œæ…¢æ—¥å¿—ï¼‰ï¼Œæœ‰æƒŠå–œå“¦</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/202306011053/">
        
        
            <div class="article-image">
                
                    <img src="/../../title_pic/20.jpg" loading="lazy" data-key="202306011053" data-hash="/../../title_pic/20.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">â€œå®æ—¶æ•°æ®åŒæ­¥ï¼šæ„å»ºé«˜æ•ˆçš„ MySQL æ•°æ®åŒæ­¥æ–¹æ¡ˆâ€œ</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script
    src="https://giscus.app/client.js"
    data-repo="nangongchengfeng/nangongchengfeng.github.io"
    data-repo-id="R_kgDOIwWL4Q"
    data-category="Announcements"
    data-category-id="DIC_kwDOIwWL4c4Cg8Rs"
    data-mapping="title"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="light"
    data-lang="en"
    crossorigin="anonymous"
    async
></script>
<script>
    function setGiscusTheme(theme) {
        let giscus = document.querySelector("iframe.giscus-frame");
        if (giscus) {
            giscus.contentWindow.postMessage(
                {
                    giscus: {
                        setConfig: {
                            theme: theme,
                        },
                    },
                },
                "https://giscus.app"
            );
        }
    }

    (function () {
        addEventListener("message", (e) => {
            if (event.origin !== "https://giscus.app") return;
            handler();
        });
        window.addEventListener("onColorSchemeChange", handler);

        function handler() {
            if (document.documentElement.dataset.scheme === "light") {
                setGiscusTheme('light');
            } else {
                setGiscusTheme('dark_dimmed');
            }
        }
    })();
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2018 - 
        
        2024 å—å®«ä¹˜é£
    </section>
    
    <section class="powerby">
        
            <a href="https://beian.miit.gov.cn/" target="_blank">å¤‡æ¡ˆå·</a> <a href="https://beian.miit.gov.cn/" target="_blank">é™•ICPå¤‡2021004364å·-1</a> <br/>
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        ä¸»é¢˜ <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.16.0">Stack</a></b> ç”± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> è®¾è®¡
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
